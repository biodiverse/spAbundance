<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jeffrey W. Doser, Andrew O. Finley, Marc Kéry, Elise F. Zipkin" />

<meta name="date" content="2023-01-01" />

<title>Fitting N-mixture models in spAbundance</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Fitting N-mixture models in spAbundance</h1>
<h4 class="author">Jeffrey W. Doser, Andrew O. Finley, Marc Kéry, Elise F. Zipkin</h4>
<h4 class="date">2023</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#example-data-set-simulated-multi-species-count-data">Example data set: Simulated multi-species count data</a></li>
</ul></li>
<li><a href="#single-species-n-mixture-models">Single-species N-mixture models</a>
<ul>
<li><a href="#basic-model-description">Basic model description</a></li>
<li><a href="#fitting-single-species-n-mixture-models-with-nmix">Fitting single-species N-mixture models with <code>NMix()</code></a></li>
<li><a href="#posterior-predictive-checks">Posterior predictive checks</a></li>
<li><a href="#model-selection-using-waic">Model selection using WAIC</a></li>
<li><a href="#prediction">Prediction</a></li>
</ul></li>
<li><a href="#spNMix">Single-species spatial N-mixture models</a>
<ul>
<li><a href="#basic-model-description-1">Basic model description</a></li>
<li><a href="#fitting-single-species-spatial-n-mixture-models-with-spnmix">Fitting single-species spatial N-mixture models with <code>spNMix()</code></a></li>
<li><a href="#posterior-predictive-checks-1">Posterior predictive checks</a></li>
<li><a href="#model-selection-using-waic-1">Model selection using WAIC</a></li>
<li><a href="#prediction-1">Prediction</a></li>
</ul></li>
<li><a href="#multi-species-n-mixture-models">Multi-species N-mixture models</a>
<ul>
<li><a href="#basic-model-description-2">Basic model description</a></li>
<li><a href="#fitting-multi-species-n-mixture-models-with-msnmix">Fitting multi-species N-mixture models with <code>msNMix()</code></a></li>
<li><a href="#posterior-predictive-checks-2">Posterior predictive checks</a></li>
<li><a href="#model-selection-using-waic-2">Model selection using WAIC</a></li>
<li><a href="#prediction-2">Prediction</a></li>
</ul></li>
<li><a href="#latent-factor-multi-species-n-mixture-models">Latent factor multi-species N-mixture models</a>
<ul>
<li><a href="#basic-model-description-3">Basic model description</a></li>
<li><a href="#fitting-latent-factor-multi-species-n-mixture-models-with-lfmsnmix">Fitting latent factor multi-species N-mixture models with <code>lfMsNMix()</code></a></li>
<li><a href="#posterior-predictive-checks-3">Posterior predictive checks</a></li>
<li><a href="#model-selection-using-waic-3">Model selection using WAIC</a></li>
<li><a href="#prediction-3">Prediction</a></li>
</ul></li>
<li><a href="#spatial-factor-multi-species-n-mixture-models">Spatial factor multi-species N-mixture models</a>
<ul>
<li><a href="#basic-model-description-4">Basic model description</a></li>
<li><a href="#fitting-spatial-factor-multi-species-n-mixture-models-with-sfmsnmix">Fitting spatial factor multi-species N-mixture models with <code>sfMsNMix()</code></a></li>
<li><a href="#posterior-predictive-checks-4">Posterior predictive checks</a></li>
<li><a href="#model-selection-using-waic-4">Model selection using WAIC</a></li>
<li><a href="#prediction-4">Prediction</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette provides worked examples and explanations for fitting single-species and multi-species N-mixture models in the <code>spAbundance</code> R package. We will provide step by step examples on how to fit the following models:</p>
<ol style="list-style-type: decimal">
<li>N-mixture model using <code>NMix()</code>.</li>
<li>Spatial N-mixture model using <code>spNMix()</code>.</li>
<li>Multi-species N-mixture model using <code>msNMix()</code>.</li>
<li>Multi-species N-mixture model with species correlations using <code>lfMsNMix()</code>.</li>
<li>Spatial multi-species N-mixture with species correlations using <code>sfMsNMix()</code>.</li>
</ol>
<p>In this vignette we are only describing <code>spAbundance</code> functionality to fit N-mixture models, with separate vignettes on fitting hierarchical distance sampling models and generalized linear mixed models. We fit all models in a Bayesian framework using custom Markov chain Monte Carlo (MCMC) samplers written in <code>C/C++</code> and called through <code>R</code>’s foreign language interface. Here we will provide a brief description of each model, with full statistical details provided in a separate vignette. As with all model types in <code>spAbundance</code>, we will show how to perform posterior predictive checks as a Goodness of Fit assessment, model comparison and assessment using the Widely Applicable Information Criterion (WAIC), and out-of-sample predictions using standard R helper functions (e.g., <code>predict()</code>). Note that syntax of N-mixture models in <code>spAbundance</code> closely follows syntax for fitting occupancy models in <code>spOccupancy</code> <span class="citation">(Doser et al. 2022)</span>, and that this vignette closely follows the documentation on the <a href="https://www.jeffdoser.com/files/spoccupancy-web/">spOccupancy website</a>.</p>
<p>To get started, we load the <code>spAbundance</code> package, as well as the <code>coda</code> package, which we will use for some MCMC summary and diagnostics. We will also use the <code>stars</code> and <code>ggplot2</code> packages to create some basic plots of our results. We then set a seed so you can reproduce the same results as we do.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(spAbundance)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(coda)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="kw">library</span>(stars)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span></code></pre></div>
<div id="example-data-set-simulated-multi-species-count-data" class="section level2">
<h2>Example data set: Simulated multi-species count data</h2>
<p>As an example data set throughout this vignette, we will use a simulated data set comprised of 6 species across 225 sites and 5 repeat surveys. The data are provided as part of the <code>spAbundance</code> package and are loaded with <code>data(dataNMixSim)</code>. The manual page obtained using <code>help(dataNMixSim)</code> contains information on the parameter values used to generate the data set with the <code>simMsNMix()</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">data</span>(dataNMixSim) <span class="co"># Load the data set.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">str</span>(dataNMixSim) <span class="co"># Get an overview of what&#39;s in the data.</span></span></code></pre></div>
<pre><code>List of 4
 $ y         : int [1:6, 1:225, 1:5] 0 0 1 0 0 0 0 0 0 0 ...
 $ abund.covs: num [1:225, 1:2] 0.2863 -0.0325 -0.9897 0.2118 -0.972 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:2] &quot;abund.cov.1&quot; &quot;abund.factor.1&quot;
 $ det.covs  :List of 2
  ..$ det.cov.1: num [1:225, 1:5] 1.577 0.6956 -0.3031 0.107 0.0284 ...
  ..$ det.cov.2: num [1:225, 1:5] -1.235 -0.509 -2.012 -0.899 0.38 ...
 $ coords    : num [1:225, 1:2] 0 0.0714 0.1429 0.2143 0.2857 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:2] &quot;X&quot; &quot;Y&quot;</code></pre>
<p>Thus, the object <code>dataNMixSim</code> is a list comprised of the count data (<code>y</code>), covariates on the abundance portion of the model (<code>abund.covs</code>), covariates on the detection portion of the model (<code>det.covs</code>), and the spatial coordinates of each site (<code>coords</code>) for use in spatial N-mixture models and in plotting. This list is in the exact format required for input to N-mixture models in <code>spAbundance</code>. <code>dataNMixSim</code> contains data on 6 species in the three-dimensional array <code>y</code>, where the dimensions of <code>y</code> correspond to species (6), sites (225), and replicates (5). For single-species N-mixture models in Section 2 and 3, we will only use data on one species, so we next subset the <code>dataNmixSim</code> list to only include data from the first species in a new object <code>data.one.sp</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>data.one.sp &lt;-<span class="st"> </span>dataNMixSim</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>data.one.sp<span class="op">$</span>y &lt;-<span class="st"> </span>data.one.sp<span class="op">$</span>y[<span class="dv">1</span>, , ]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="kw">table</span>(data.one.sp<span class="op">$</span>y) <span class="co"># Quick summary.</span></span></code></pre></div>
<pre><code>
  0   1   2   3   4   5   7 
534  96  17   9   3   2   3 </code></pre>
<p>We see that our species is fairly rare, with most observations of the species being 0.</p>
</div>
</div>
<div id="single-species-n-mixture-models" class="section level1">
<h1>Single-species N-mixture models</h1>
<div id="basic-model-description" class="section level2">
<h2>Basic model description</h2>
<p>Let <span class="math inline">\(N_j\)</span> denote the true abundance of a species of interest at site <span class="math inline">\(j = 1, \dots, J\)</span>. We model <span class="math inline">\(N_j\)</span> following either a Poisson or negative binomial (NB) distribution according to</p>
<p><span class="math display">\[\begin{align}\label{abundance}
  \begin{split}
  N_j &amp;\sim \text{Poisson}(\mu_j) \text{, or, } \\
  N_j &amp;\sim \text{NB}(\mu_j, \kappa),
  \end{split}
\end{align}\]</span></p>
<p>where <span class="math inline">\(\mu_j\)</span> is the average abundance at site <span class="math inline">\(j\)</span> and <span class="math inline">\(\kappa\)</span> is a positive dispersion parameter. Smaller values of <span class="math inline">\(\kappa\)</span> indicate overdispersion in the latent abundance values, while higher values indicate minimal overdispersion in abundance. We model <span class="math inline">\(\mu_j\)</span> using a log link function following</p>
<p><span class="math display">\[\begin{equation}\label{muAbund}
  \text{log}(\mu_j) = \textbf{x}_j^\top\boldsymbol{\beta},
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\beta}\)</span> is a vector of regression coefficients for a set of covariates <span class="math inline">\(\textbf{X}_j\)</span> (including an intercept). Note that while not shown, unstructured random intercepts and slopes can be included in the equation for expected abundance.</p>
<p>Following the standard N-mixture model of <span class="citation">Royle (2004)</span>, we suppose observers count the number of individuals of the species of interest at each site <span class="math inline">\(j\)</span> over a set of multiple surveys <span class="math inline">\(k = 1, \dots, K_j\)</span>, denoted as <span class="math inline">\(y_{j, k}\)</span>. Note the number of surveys can vary by site, but at least some sites must be surveyed more than once to ensure identifiability. We model <span class="math inline">\(y_{j, k}\)</span> conditional on the true abundance of the species at site <span class="math inline">\(j\)</span>, <span class="math inline">\(N_j\)</span>, following</p>
<p><span class="math display">\[\begin{equation}\label{y-NMix}
     y_{j, k} \sim \text{Binomial}(N_j, p_{j, k}),
\end{equation}\]</span></p>
<p>where <span class="math inline">\(p_{j, k}\)</span> is the probability of detecting an individual given it is present at the site. We model <span class="math inline">\(p_{j, k}\)</span> using a logit link function in which we can allow detection probability to vary over space and/or surveys. More specifically, we have</p>
<p><span class="math display">\[\begin{equation} \label{p-NMix}
     \text{logit}(p_{j, k}) = \textbf{v}_{j, k}^\top\boldsymbol{\alpha},
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\alpha}\)</span> is a vector of the effects of a set of covariates <span class="math inline">\(\textbf{v}_{j, k}\)</span> (including an intercept).</p>
<p>To complete the Bayesian specification of the model, we assign normal priors for the abundance (<span class="math inline">\(\boldsymbol{\beta}\)</span>) and detection (<span class="math inline">\(\boldsymbol{\alpha}\)</span>) regression coefficients.</p>
</div>
<div id="fitting-single-species-n-mixture-models-with-nmix" class="section level2">
<h2>Fitting single-species N-mixture models with <code>NMix()</code></h2>
<p>The <code>NMix()</code> function fits single-species N-mixture models. <code>NMix()</code> has the following arguments:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">NMix</span>(abund.formula, det.formula, data, inits, priors, tuning,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>     n.batch, batch.length, <span class="dt">accept.rate =</span> <span class="fl">0.43</span>, <span class="dt">family =</span> <span class="st">&#39;Poisson&#39;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>     <span class="dt">n.omp.threads =</span> <span class="dv">1</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>, <span class="dt">n.report =</span> <span class="dv">100</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>     <span class="dt">n.burn =</span> <span class="kw">round</span>(.<span class="dv">10</span> <span class="op">*</span><span class="st"> </span>n.batch <span class="op">*</span><span class="st"> </span>batch.length), <span class="dt">n.thin =</span> <span class="dv">1</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>     <span class="dt">n.chains =</span> <span class="dv">1</span>, ...)</span></code></pre></div>
<p>The first two arguments, <code>abund.formula</code> and <code>det.formula</code>, use standard R model syntax to denote the covariates to be included in the abundance and detection portions of the model, respectively. Only the right hand side of the formulas are included. Random intercepts and slopes can be included in both the abundance and detection portions of the single-species N-mixture model using <code>lme4</code> syntax <span class="citation">(Bates et al. 2015)</span>. For example, to include a random intercept for different observers in the detection portion of the model, we would include <code>(1 | observer)</code> in the <code>det.formula</code>, where <code>observer</code> indicates the specific observer for each data point. The names of variables given in the formulas should correspond to those found in <code>data</code>, which is a list consisting of the following tags: <code>y</code> (count data), <code>abund.covs</code> (abundance covariates), <code>det.covs</code> (detection covariates). <code>y</code> should be stored as a sites x replicate matrix, <code>abund.covs</code> as a matrix or data frame with site-specific covariate values, and <code>det.covs</code> as a list with each list element corresponding to a covariate to include in the detection portion of the model. Covariates on detection can vary by site and/or survey, and so these covariates may be specified as a site by survey matrix for survey-level covariates or as a one-dimensional vector for survey level covariates. The <code>data.one.sp</code> list is already in the required format. Here we will model abundance as a function of a continuous covariate <code>abund.cov.1</code> as well as a categorical variable <code>abund.factor.1</code>, which we will treat as a random effect. We can imagine this categorical variable corresponding to a management unit, aspect of the experimental design, or some other grouping variable that we want to account for in our model. We model detection probability as a function of two continuous variables that vary across sites and replicates. We standardize all continuous covariates by using the <code>scale()</code> function in our model specification:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a>abund.formula &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">scale</span>(abund.cov<span class="fl">.1</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>abund.factor<span class="fl">.1</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>det.formula &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">scale</span>(det.cov<span class="fl">.1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(det.cov<span class="fl">.2</span>) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="co"># Check out the format of data.one.sp</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="kw">str</span>(data.one.sp)</span></code></pre></div>
<pre><code>List of 4
 $ y         : int [1:225, 1:5] 0 0 1 0 0 0 0 0 0 0 ...
 $ abund.covs: num [1:225, 1:2] 0.2863 -0.0325 -0.9897 0.2118 -0.972 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:2] &quot;abund.cov.1&quot; &quot;abund.factor.1&quot;
 $ det.covs  :List of 2
  ..$ det.cov.1: num [1:225, 1:5] 1.577 0.6956 -0.3031 0.107 0.0284 ...
  ..$ det.cov.2: num [1:225, 1:5] -1.235 -0.509 -2.012 -0.899 0.38 ...
 $ coords    : num [1:225, 1:2] 0 0.0714 0.1429 0.2143 0.2857 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:2] &quot;X&quot; &quot;Y&quot;</code></pre>
<p>Next, we specify the initial values for the MCMC sampler in <code>inits</code>. <code>NMix()</code> (and all other <code>spAbundance</code> model fitting functions) will set initial values by default, but here we will do this explicitly, since in more complicated cases setting initial values close to the presumed solutions can be vital for success of an MCMC-based analysis. For all models described in this vignette (in particular the non-spatial models), choice of the initial values is largely inconsequential, with the exception being that specifying initial values close to the presumed solutions can decrease the amount of samples you need to run to arrive at convergence of the MCMC chains. Thus, when first running a model in <code>spAbundance</code>, we recommend fitting the model using the default initial values that <code>spAbundance</code> provides. The initial values that <code>spAbundance</code> chooses will be reported to the screen when setting <code>verbose = TRUE</code>. After running the model for a reasonable period, if you find the chains are taking a long time to reach convergence, you then may wish to set the initial values to the mean estimates of the parameters from the initial model fit, as this will likely help reduce the amount of time you need to run the model.</p>
<p>The default initial values for abundance and detection regression coefficients (including the intercepts) are random values from a standard normal distribution, while the default initial values for the latent abundance effects are set to the maximum number of individuals observed at a given site over the replicate surveys at that site. When fitting an N-mixture model with a negative binomial distribution, the initial value for the overdispersion parameter is drawn from the prior distribution. Initial values are specified in a list with the following tags: <code>N</code> (latent abundance values), <code>alpha</code> (detection intercept and regression coefficients), <code>beta</code> (abundance intercept and regression coefficients), and <code>kappa</code> (negative binomial overdispersion parameter). Below we set all initial values of the regression coefficients to 0, initial values for the overdispersion parameter to 0.5, and set initial values for <code>N</code> based on the count data matrix. For the abundance (<code>beta</code>) and detection (<code>alpha</code>) regression coefficients, the initial values are passed either as a vector of length equal to the number of estimated parameters (including an intercept, and in the order specified in the model formula), or as a single value if setting the same initial value for all parameters (including the intercept). Below we take the latter approach. For the negative binomial overdispersion parameter, the initial value is simply a single numeric value. To specify the initial values for the latent abundance at each site (<code>N</code>), we must ensure we set the value to at least the maximum number of individuals observed at a site on a given survey, because we know the true abundance must be greater than or equal to the number of individuals observed (i.e., assuming no false positives). If the initial values for <code>N</code> do not meet this criterion, <code>NMix()</code> will fail. <code>spAbundance</code> will provide a clear error message if the supplied initial values for <code>N</code> are invalid. Below we use the raw count data and the <code>apply()</code> function to set the initial values to the largest observed count at each site. For any random effects that are included in the model, we can also specify the initial values for the random effect variances (<code>sigma.sq.mu</code> for abundance and <code>sigma.sq.p</code> for detection. By default, these will be drawn as random values between 0.05 and 2. Here we specify the initial value for the abundance random effect to 0.5.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co"># Format with explicit specification of inits for alpha and beta</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="co"># with four detection parameters and three occurrence parameters</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="co"># (including the intercept).</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>inits &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a>              <span class="dt">beta =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>              <span class="dt">kappa =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a>          <span class="dt">sigma.sq.mu =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>              <span class="dt">N =</span> <span class="kw">apply</span>(data.one.sp<span class="op">$</span>y, <span class="dv">1</span>, max, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a><span class="co"># Format with abbreviated specification of inits for alpha and beta.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>inits &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">0</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a>              <span class="dt">beta =</span> <span class="dv">0</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a>              <span class="dt">kappa =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a>          <span class="dt">sigma.sq.mu =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a>              <span class="dt">N =</span> <span class="kw">apply</span>(data.one.sp<span class="op">$</span>y, <span class="dv">1</span>, max, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<p>We next specify the priors for the abundance and detection regression coefficients, as well as the negative binomial overdispersion parameter. We assume normal priors for both the detection and abundance regression coefficients. These priors are specified in a list with tags <code>beta.normal</code> for abundance and <code>alpha.normal</code> for detection parameters (including intercepts). Each list element is then itself a list, with the first element of the list consisting of the hypermeans for each coefficient and the second element of the list consisting of the hypervariances for each coefficient. Alternatively, the hypermean and hypervariances can be specified as a single value if the same prior is used for all regression coefficients. By default, <code>spOccupancy</code> will set the hypermeans to 0 and the hypervariances to 100 for the abundance coefficients and 2.72 for the detection coefficients. The variance of 2.72 corresponds to a relatively flat prior on the probability scale (0, 1; <span class="citation">Lunn et al. (2013)</span>). For the negative binomial overdispersion parameter, we will use a uniform prior. This prior is specified as a tag in the prior list called <code>kappa.unif</code>, which should be a vector with two values indicating the lower and upper bound of the uniform distribution. The default prior is to set the lower bound to 0 and the upper bound to 100. Recall that lower values of <code>kappa</code> indicate substantial overdispersion and high values of <code>kappa</code> indicate minimal overdispersion. If there is little support for overdispersion when fitting a negative binomial model, we will likely see the estimates of <code>kappa</code> be close to the upper bound of the uniform prior distribution. For the default prior distribution, if the estimates of <code>kappa</code> are very close to 100, this indicates little support for overdispersion in the model, and we can likely switch to using a Poisson distribution (which would also likely be favored by model comparison approaches). For models with random effects in the abundance and/or detection portion of the N-mixture model, we can also specify the prior for the random effect ariance parameter (<code>sigma.sq.mu</code> for abundance and <code>sigma.sq.p</code> for detection). We assume an inverse-Gamma prior for these variance parameters and these are specified with the tags <code>sigma.sq.mu.ig</code> and <code>sigma.sq.p.ig</code>, respectively. These priors are set as a list with two components, where the first element is the shape parameter and the second element is the scale parameter. The shape and scale parameters can be specified as a single value or vectors equal to the number of random effects we include in the model. The default prior distribution for random effect variances is 0.1 for both the shape and scale parameters. Below we use default priors for all parameters, but specify them explicitly for clarity.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>priors &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">alpha.normal =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">var =</span> <span class="fl">2.72</span>),</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>               <span class="dt">beta.normal =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">var =</span> <span class="dv">100</span>), </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>               <span class="dt">kappa.unif =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>               <span class="dt">sigma.sq.mu.ig =</span> <span class="kw">list</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<p>The next four arguments (<code>tuning</code>, <code>n.batch</code>, <code>batch.length</code>, and <code>accept.rate</code>) are all related to the specific type of MCMC sampler we use when we fit N-mixture models in <code>spAbundance</code>. The parameters in N-mixture models are all estimated using whats called a Metropolis-Hastings step, which can often be slow and inefficient, leading to slow mixing and convergence of the MCMC chains. To try and mitigate the slow mixing and convergence issues, we update all parameters in N-mixture models using an algorithm called an adaptive Metropolis-Hastings algorithm (see <span class="citation">Roberts and Rosenthal (2009)</span> for more details on this algorithm). In this approach, we break up the total number of MCMC samples into a set of “batches”, where each batch has a specific number of MCMC samples. Thus, we must specify the total number of batches (<code>n.batch</code>) as well as the number of MCMC samples each batch contains (<code>batch.length</code>) when specifying the function arguments. The total number of MCMC samples is <code>n.batch * batch.length</code>. Typically, we set <code>batch.length = 25</code> and then play around with <code>n.batch</code> until convergence of all model parameters is reached. We generally recommend setting <code>batch.length = 25</code>, but in certain situations this can be increased to a larger number of samples (e.g., 100), which can result in moderate decreases in run time. Here we set <code>n.batch = 800</code> for a total of 20,000 MCMC samples for each MCMC chain we run.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>batch.length &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>n.batch &lt;-<span class="st"> </span><span class="dv">800</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="co"># Total number of MCMC samples per chain</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>batch.length <span class="op">*</span><span class="st"> </span>n.batch</span></code></pre></div>
<pre><code>[1] 20000</code></pre>
<p>Importantly, we also need to specify a target acceptance rate and initial tuning parameters for the abundance and detection regression coefficients (and the negative binomial overdispersion parameter and any latent random effects if applicable). These are both features of the adaptive algorithm we use to sample these parameters. In this adaptive Metropolis-Hastings algorithm, we propose new values for the parameters from some proposal distribution, compare them to our previous values, and use a statistical algorithm to determine if we should accept the new proposed value or keep the old one. The <code>accept.rate</code> argument specifies the ideal proportion of times we will accept the newly proposed values for these parameters. <span class="citation">Roberts and Rosenthal (2009)</span> show that if we accept new values around 43% of the time, this will lead to optimal mixing and convergence of the MCMC chains. Following these recommendations, we should strive for an algorithm that accepts new values about 43% of the time. Thus, we recommend setting <code>accept.rate = 0.43</code> unless you have a specific reason not to (this is the default value). The values specified in the <code>tuning</code> argument help control the initial values we will propose for the abundance/detection coefficients and the negative binomial overdispersion parameter. These values are supplied as input in the form of a list with tags <code>beta</code>, <code>alpha</code>, and <code>kappa</code>. The initial tuning value can be any value greater than 0, but we generally recommend starting the value out around 0.5. These tuning values can also be thought of as tuning “variances”, as it is these values that controls the variance of the distribution we use to generate newly proposed values for the parameters we are trying to estimate. In short, the new values that we propose for the parameters <code>beta</code>, <code>alpha</code>, and <code>kappa</code> come from a normal distribution with mean equal to the current value for the given parameter and the variance equal to the tuning parameter. Thus, the smaller this tuning parameter/variance is, the closer our proposed values will be to the current value, and vise versa for large values of the tuning parameter. The “ideal” value of the tuning variance will depend on the data set, the parameter, and how much uncertainty there is in the estimate of the parameter. This initial tuning value that we supply is the first tuning variance that will be used for the given parameter, and our adaptive algorithm will adjust this tuning parameter after each batch to yield acceptance rates of newly proposed values that are close to our target acceptance rate that we specified in the <code>accept.rate</code> argument. Information on the acceptance rates for a few of the parameters in your model will be displayed when setting <code>verbose = TRUE</code>. After some initial runs of the model, if you notice the final acceptance rate is much larger or smaller than the target acceptance rate (<code>accept.rate</code>), you can then change the initial tuning value to get closer to the target rate. While use of this algorithm requires us to specify more arguments than if we didn’t “adaptively tune” our proposal variances, this leads to much shorter run times compared to a more simple approach where we do not have an “adaptive” sampling approach, and it should thus save us time in the long haul when waiting for these models to run. For our example here, we set the initial tuning values to 0.5 for <code>beta</code>, <code>alpha</code>, and <code>kappa</code>. For models with random effects in either the abundance or detection portions of the model, we also need to specify tuning parameters for the latent random effect values (<code>beta.star</code> for abundance and <code>alpha.star</code> for detection). We similarly set these to 0.5.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>tuning &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">beta =</span> <span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">kappa =</span> <span class="fl">0.5</span>, <span class="dt">beta.star =</span> <span class="fl">0.5</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a><span class="co"># accept.rate = 0.43 by default, so we do not specify it.</span></span></code></pre></div>
<p>We also need to specify the length of burn-in (<code>n.burn</code>), the rate at which we want to thin the posterior samples (<code>n.thin</code>), and the number of MCMC chains to run (<code>n.chains</code>). Note that currently <code>spAbundance</code> runs multiple chains sequentially and does not allow chains to be run simultaneously in parallel across multiple threads. Instead, we allow for within-chain parallelization using the <code>n.omp.threads</code> argument. We can set <code>n.omp.threads</code> to a number greater than 1 and smaller than the number of threads on the computer you are using. Generally, setting <code>n.omp.threads &gt; 1</code> will not result in decreased run times for non-spatial models in <code>spAbundance</code>, but can substantially decrease run time when fitting spatial models <span class="citation">(Finley, Datta, and Banerjee 2020)</span>. Here we set <code>n.omp.threads = 1</code>.</p>
<p>For a simple single-species N-mixture model, we shouldn’t need too many samples and will only need a moderate amount of burn-in and thinning. We will run the model using three chains to assess convergence using the Gelman-Rubin diagnostic (Rhat; <span class="citation">Brooks and Gelman (1998)</span>).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>n.burn &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>n.thin &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>n.chains &lt;-<span class="st"> </span><span class="dv">3</span></span></code></pre></div>
<p>We are now almost set to run the model. The <code>family</code> argument is used to indicate whether we want to model abundance with a Poisson distribution (<code>Poisson</code>) or a negative binomial distribution (<code>NB</code>). Here we will start with a Poisson distribution (the default), which we will compare to a model with a negative binomial distribution later. The <code>verbose</code> argument is a logical value indicating whether or not MCMC sampler progress is reported to the screen. If <code>verbose = TRUE</code>, sampler progress is reported to the screen. The argument <code>n.report</code> specifies the interval to report the Metropolis-Hastings sampler acceptance rate. Note that <code>n.report</code> is specified in terms of batches, not the overall number of samples. Below we set <code>n.report = 200</code>, which will result in information on the acceptance rate and tuning parameters every 200th batch (not sample).</p>
<p>We now are set to fit the model.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>out &lt;-<span class="st"> </span><span class="kw">NMix</span>(<span class="dt">abund.formula =</span> abund.formula, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>        <span class="dt">det.formula =</span> det.formula, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>        <span class="dt">data =</span> data.one.sp, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>        <span class="dt">inits =</span> inits, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a>        <span class="dt">priors =</span> priors,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a>        <span class="dt">n.batch =</span> n.batch,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>        <span class="dt">batch.length =</span> batch.length, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a>        <span class="dt">tuning =</span> tuning, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>        <span class="dt">n.omp.threads =</span> <span class="dv">1</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>        <span class="dt">n.report =</span> <span class="dv">200</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a>        <span class="dt">family =</span> <span class="st">&#39;Poisson&#39;</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a>        <span class="dt">verbose =</span> <span class="ot">TRUE</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a>        <span class="dt">n.burn =</span> n.burn,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true"></a>        <span class="dt">n.thin =</span> n.thin, </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true"></a>        <span class="dt">n.chains =</span> n.chains)</span></code></pre></div>
<pre><code>----------------------------------------
    Preparing to run the model
----------------------------------------
----------------------------------------
    Model description
----------------------------------------
Poisson N-mixture model with 225 sites.

Samples per Chain: 20000 (800 batches of length 25)
Burn-in: 10000 
Thinning Rate: 10 
Number of Chains: 3 
Total Posterior Samples: 3000 

Source compiled with OpenMP support and model fit using 1 thread(s).

Adaptive Metropolis with target acceptance rate: 43.0
----------------------------------------
    Chain 1
----------------------------------------
Sampling ... 
Batch: 200 of 800, 25.00%
    Parameter   Acceptance  Tuning
    beta[1]     36.0        0.26102
    beta[2]     40.0        0.26102
    alpha[1]    52.0        0.35946
    alpha[2]    36.0        0.54709
    alpha[3]    32.0        0.37413
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Parameter   Acceptance  Tuning
    beta[1]     40.0        0.25585
    beta[2]     48.0        0.27168
    alpha[1]    36.0        0.36672
    alpha[2]    40.0        0.53625
    alpha[3]    48.0        0.37413
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Parameter   Acceptance  Tuning
    beta[1]     28.0        0.25079
    beta[2]     52.0        0.26630
    alpha[1]    36.0        0.34537
    alpha[2]    40.0        0.53625
    alpha[3]    36.0        0.38169
-------------------------------------------------
Batch: 800 of 800, 100.00%
----------------------------------------
    Chain 2
----------------------------------------
Sampling ... 
Batch: 200 of 800, 25.00%
    Parameter   Acceptance  Tuning
    beta[1]     60.0        0.26102
    beta[2]     48.0        0.26102
    alpha[1]    28.0        0.38940
    alpha[2]    52.0        0.53625
    alpha[3]    28.0        0.33853
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Parameter   Acceptance  Tuning
    beta[1]     48.0        0.26102
    beta[2]     40.0        0.26102
    alpha[1]    48.0        0.38169
    alpha[2]    32.0        0.51523
    alpha[3]    40.0        0.37413
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Parameter   Acceptance  Tuning
    beta[1]     36.0        0.26102
    beta[2]     52.0        0.28276
    alpha[1]    40.0        0.35946
    alpha[2]    40.0        0.56941
    alpha[3]    44.0        0.35234
-------------------------------------------------
Batch: 800 of 800, 100.00%
----------------------------------------
    Chain 3
----------------------------------------
Sampling ... 
Batch: 200 of 800, 25.00%
    Parameter   Acceptance  Tuning
    beta[1]     48.0        0.26630
    beta[2]     44.0        0.25585
    alpha[1]    48.0        0.34537
    alpha[2]    56.0        0.51523
    alpha[3]    32.0        0.37413
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Parameter   Acceptance  Tuning
    beta[1]     36.0        0.26630
    beta[2]     40.0        0.25079
    alpha[1]    40.0        0.38169
    alpha[2]    76.0        0.55814
    alpha[3]    56.0        0.36672
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Parameter   Acceptance  Tuning
    beta[1]     44.0        0.27716
    beta[2]     48.0        0.27168
    alpha[1]    44.0        0.38940
    alpha[2]    44.0        0.52564
    alpha[3]    32.0        0.40529
-------------------------------------------------
Batch: 800 of 800, 100.00%</code></pre>
<p><code>NMix()</code> returns a list of class <code>NMix</code> with a suite of different objects, many of them being <code>coda::mcmc</code> objects of poseterior samples. The “Preparing to run the model” section will print information on default priors or initial values that are used when they are not specified in the function call. Here we specified everything explicitly so no information was reported.</p>
<p>We next use the <code>summary()</code> function on the resulting <code>NMix()</code> object for a concise, informative summary of the regression parameters and convergence of the MCMC chains.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="kw">summary</span>(out)</span></code></pre></div>
<pre><code>
Call:
NMix(abund.formula = abund.formula, det.formula = det.formula, 
    data = data.one.sp, inits = inits, priors = priors, tuning = tuning, 
    n.batch = n.batch, batch.length = batch.length, family = &quot;Poisson&quot;, 
    n.omp.threads = 1, verbose = TRUE, n.report = 200, n.burn = n.burn, 
    n.thin = n.thin, n.chains = n.chains)

Samples per Chain: 20000
Burn-in: 10000
Thinning Rate: 10
Number of Chains: 3
Total Posterior Samples: 3000
Run Time (min): 0.3545

Abundance (log scale): 
                      Mean     SD    2.5%     50%   97.5%   Rhat  ESS
(Intercept)        -0.9963 0.2950 -1.6293 -0.9805 -0.4467 1.0142  408
scale(abund.cov.1)  0.1049 0.1138 -0.1136  0.1038  0.3338 1.0012 2284

Abundance Random Effect Variances (log scale): 
                             Mean     SD   2.5%    50%  97.5%   Rhat  ESS
(Intercept)-abund.factor.1 0.6936 0.5535 0.1555 0.5446 2.1997 1.0128 1976

Detection (logit scale): 
                    Mean     SD    2.5%     50%  97.5%   Rhat  ESS
(Intercept)       0.9400 0.1945  0.5732  0.9364 1.3385 1.0081 1753
scale(det.cov.1)  1.9916 0.2481  1.5273  1.9859 2.4967 1.0115 2108
scale(det.cov.2) -0.0032 0.1539 -0.3097 -0.0064 0.2992 1.0022 2421</code></pre>
<p>Notice that the abundance coefficients are printed on the log scale and the detection coefficients are on the logit scale. We see that our species is quite rare, with an average expected abundance of approximately 0.37 (<code>exp(-1)</code>). There is a slight positive effect of the covariate effect, but its 95% credible interval clearly overlaps 0. The random effect variance mean is approximately 0.69, indicating this is a potentially important source of variability in abundance for the species. Note that we can also change the quantiles that are returned in the summary output if we desire to see additional quantiles. This is controlled with the <code>quantiles</code> argument.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="co"># Return a 50% CI and the median instead of the 95% CI</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="kw">summary</span>(out, <span class="dt">quantiles =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>))</span></code></pre></div>
<pre><code>
Call:
NMix(abund.formula = abund.formula, det.formula = det.formula, 
    data = data.one.sp, inits = inits, priors = priors, tuning = tuning, 
    n.batch = n.batch, batch.length = batch.length, family = &quot;Poisson&quot;, 
    n.omp.threads = 1, verbose = TRUE, n.report = 200, n.burn = n.burn, 
    n.thin = n.thin, n.chains = n.chains)

Samples per Chain: 20000
Burn-in: 10000
Thinning Rate: 10
Number of Chains: 3
Total Posterior Samples: 3000
Run Time (min): 0.3545

Abundance (log scale): 
                      Mean     SD     25%     50%     75%   Rhat  ESS
(Intercept)        -0.9963 0.2950 -1.1701 -0.9805 -0.8103 1.0142  408
scale(abund.cov.1)  0.1049 0.1138  0.0262  0.1038  0.1818 1.0012 2284

Abundance Random Effect Variances (log scale): 
                             Mean     SD    25%    50%    75%   Rhat  ESS
(Intercept)-abund.factor.1 0.6936 0.5535 0.3578 0.5446 0.8356 1.0128 1976

Detection (logit scale): 
                    Mean     SD     25%     50%    75%   Rhat  ESS
(Intercept)       0.9400 0.1945  0.8106  0.9364 1.0704 1.0081 1753
scale(det.cov.1)  1.9916 0.2481  1.8187  1.9859 2.1560 1.0115 2108
scale(det.cov.2) -0.0032 0.1539 -0.1035 -0.0064 0.1005 1.0022 2421</code></pre>
<p>The model summary also provides information on convergence of the MCMC chains in the form of the Gelman-Rubin diagnostic <span class="citation">(Brooks and Gelman 1998)</span> and the effective sample size (ESS) of the posterior samples. Here we find all Rhat values are less than 1.1 and the ESS values are substantially large for all parameters. The ESS values are also adequately high for all model parameters, indicating adequate mixing of the MCMC chains.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co"># Abundance parameters</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a><span class="kw">plot</span>(out<span class="op">$</span>beta.samples, <span class="dt">density =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="co"># Detection parameters</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="kw">plot</span>(out<span class="op">$</span>alpha.samples, <span class="dt">density =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="posterior-predictive-checks" class="section level2">
<h2>Posterior predictive checks</h2>
<p>The function <code>ppcAbund()</code> performs a posterior predictive check on all <code>spAbundance</code> model objects as a Goodness of Fit (GoF) assessment. The fundamental idea of GoF testing is that a good model should generate data that closely align with the observed data. If there are drastic differences in the true data from the model generated data, our model is likely not very useful <span class="citation">(Hobbs and Hooten 2015)</span>. In <code>spAbundance</code>, we perform posterior predictive checks using the following approach:</p>
<ol style="list-style-type: decimal">
<li>Fit the model using any of the model-fitting functions (here <code>NMix()</code>), which generates replicated values for all observed data points.</li>
<li>Optionally bin both the actual and the replicated count data in some manner, such as by site or replicate.</li>
<li>Compute a fit statistic on both the actual data and also on the model-generated ‘replicate data’.</li>
<li>Compare the fit statistics for the true data and replicate data. If they are widely different, this suggests a lack of fit of the model to the actual data set at hand.</li>
</ol>
<p>To perform a posterior predictive check, we send the resulting <code>NMix</code> model object as input to the <code>ppcAbund()</code> function, along with a fit statistic (<code>fit.stat</code>) and a numeric value indicating how to group, or bin, the data (<code>group</code>). Currently supported fit statistics include the Freeman-Tukey statistic and the Chi-Squared statistic (<code>freeman-tukey</code> or <code>chi-squared</code>, respectively, <span class="citation">Kéry and Royle (2016)</span>). Currently, <code>ppcAbund()</code> allows the user to group the data by row (site; <code>group = 1</code>), column (replicate; <code>group = 2</code>), or not at all (<code>group = 0</code>). <code>ppcAbund()</code> will then return a set of posterior samples for the fit statistic (or discrepancy measure) using the actual data (<code>fit.y</code>) and model generated replicate data set (<code>fit.y.rep</code>), summed across all data points in the chosen manner. We generally recommend performing a posterior predictive check using all forms of grouping, as they may reveal (or fail to reveal) different inadequacies of the model for the specific data set at hand <span class="citation">(Kéry and Royle 2016)</span>. Throughout this vignette, we will display different types of poseterior predictive checks using different combinations of the fit statistic and grouping approach.</p>
<p>The resulting values from a call to <code>ppcAbund()</code> can be used with the <code>summary()</code> function to generate a Bayesian p-value, which is the probability, under the fitted model, to obtain a value of the fit statistic that is more extreme (i.e., larger) than the one observed, i.e., for the actual data. Bayesian p-values are sensitive to individual values, so we may also want to explore the discrepancy measures for each (potentially “grouped”) data point. <code>ppcAbund()</code> returns a matrix of posterior quantiles for the fit statistic for both the observed (<code>fit.y.group.quants</code>) and model generated, replicate data (<code>fit.y.rep.group.quants</code>) for each “grouped” data point.</p>
<p>We next perform a posterior predictive check using the Freeman-Tukey statistic grouping the data by sites. We summarize the posterior predictive check with the <code>summary()</code> function, which reports a Bayesian p-value. A Bayesian p-value that hovers around 0.5 indicates adequate model fit, while values less than 0.1 or greater than 0.9 suggest our model does not fit the data well <span class="citation">(Hobbs and Hooten 2015)</span>. As always with a simulation-based analysis using MCMC, you will get numerically slightly different values.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>ppc.out &lt;-<span class="st"> </span><span class="kw">ppcAbund</span>(out, <span class="dt">fit.stat =</span> <span class="st">&#39;freeman-tukey&#39;</span>, <span class="dt">group =</span> <span class="dv">1</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="kw">summary</span>(ppc.out)</span></code></pre></div>
<pre><code>
Call:
ppcAbund(object = out, fit.stat = &quot;freeman-tukey&quot;, group = 1)

Samples per Chain: 20000
Burn-in: 10000
Thinning Rate: 10
Number of Chains: 3
Total Posterior Samples: 3000

Bayesian p-value:  0.272 
Fit statistic:  freeman-tukey </code></pre>
<p>The Bayesian p-value is greater than 0.1 and less than 0.9, indicating an adequate fit to the data. See the <a href="https://www.jeffdoser.com/files/spoccupancy-web/">introductory <code>spOccupancy</code> vignette</a> for ways to further explore resulting objects from posterior predictive checks.</p>
</div>
<div id="model-selection-using-waic" class="section level2">
<h2>Model selection using WAIC</h2>
<p>Posterior predictive checks allow us to assess how well our model fits the data, but they are not very useful if we want to compare multiple competing models and ultimately select a final model based on some criterion. Bayesian model selection is very much a constantly changing field. See <span class="citation">Hooten and Hobbs (2015)</span> for an accessible overview of Bayesian model selection for ecologists.</p>
<p>For Bayesian hierarchical models like occupancy models, the most common Bayesian model selection criterion, the deviance information criterion or DIC, is not applicable <span class="citation">(Hooten and Hobbs 2015)</span>. Instead, the Widely Applicable Information Criterion <span class="citation">(Watanabe 2010)</span> is recommended to compare a set of models and select the best-performing model for final analysis.</p>
<p>The WAIC is calculated for all <code>spAbundance</code> model objects using the function <code>waicAbund()</code>. We calculate the WAIC as</p>
<p><span class="math display">\[
\text{WAIC} = -2 \times (\text{elpd} - \text{pD}),
\]</span></p>
<p>where elpd is the expected log point-wise predictive density and PD is the effective number of parameters. We calculate elpd by calculating the likelihood for each posterior sample, taking the mean of these likelihood values, taking the log of the mean of the likelihood values, and summing these values across all sites. We calculate the effective number of parameters by calculating the variance of the log likelihood for each site taken over all posterior samples, and then summing these values across all sites. See Appendix S1 from <span class="citation">Broms, Hooten, and Fitzpatrick (2016)</span> for more details.</p>
<p>We calculate the WAIC using <code>waicAbund()</code> for our model below (as always, note some slight differences with your solutions due to Monte Carlo error).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="kw">waicAbund</span>(out)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>      elpd         pD       WAIC 
-273.35113   17.14231  580.98690 </code></pre>
<p>Note the perhaps somewhat cryptic message that is displayed to the screen when you run the previous line. When calculating WAIC for N-mixture models (and distance sampling models), we need to integrate out the latent abundance values, which requires setting an upper bound to the potential value of the latent abundance values <span class="math inline">\(N_j\)</span> at each spatial location. By default, <code>waicAbund()</code> will set that upper bound to the largest abundance value at each site plus 10 (as indicated by the message). This upper bound can be controlled further with the <code>N.max</code> argument in <code>waicAbund()</code>. See the help page for <code>waicAbund</code> for details.</p>
<p>Now let’s do a bit of model comparison. We will fit three candidate models to compare to our original model:</p>
<ol style="list-style-type: decimal">
<li>A model with a Poisson distribution for abundance with the random effect on abundance (this is the model we already fit).</li>
<li>A model with a Poisson distribution for abundance without the random effect.</li>
<li>A model with a negative binomial distribution for abundance with the random effect on abundance.</li>
<li>A model with a negative binomial distribution without the random effect.</li>
</ol>
<p>We next run the three candidate models (setting <code>verbose = FALSE</code> to hide the messages printed by the model fitting functions).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="co"># Approx run time: 30 sec</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>out<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">NMix</span>(<span class="dt">abund.formula =</span> <span class="op">~</span><span class="st"> </span>abund.cov<span class="fl">.1</span>, <span class="dt">det.formula =</span> det.formula, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a>          <span class="dt">data =</span> data.one.sp, <span class="dt">inits =</span> inits, <span class="dt">priors =</span> priors,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a>          <span class="dt">n.batch =</span> n.batch, <span class="dt">batch.length =</span> batch.length, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a>          <span class="dt">tuning =</span> tuning, <span class="dt">n.omp.threads =</span> <span class="dv">1</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a>          <span class="dt">family =</span> <span class="st">&#39;Poisson&#39;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">n.burn =</span> n.burn, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a>          <span class="dt">n.thin =</span> n.thin, <span class="dt">n.chains =</span> n.chains)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a><span class="co"># Approx run time: 30 sec</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true"></a>out<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">NMix</span>(<span class="dt">abund.formula =</span> <span class="op">~</span><span class="st"> </span>abund.cov<span class="fl">.1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>abund.factor<span class="fl">.1</span>),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true"></a>          <span class="dt">det.formula =</span> det.formula, <span class="dt">data =</span> data.one.sp, </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true"></a>          <span class="dt">inits =</span> inits, <span class="dt">priors =</span> priors, <span class="dt">n.batch =</span> n.batch, </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true"></a>          <span class="dt">batch.length =</span> batch.length, <span class="dt">tuning =</span> tuning, </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true"></a>          <span class="dt">n.omp.threads =</span> <span class="dv">1</span>, <span class="dt">family =</span> <span class="st">&#39;NB&#39;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true"></a>          <span class="dt">n.burn =</span> n.burn, <span class="dt">n.thin =</span> n.thin, <span class="dt">n.chains =</span> n.chains)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true"></a><span class="co"># Approx run time: 30 sec</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true"></a>out<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">NMix</span>(<span class="dt">abund.formula =</span> <span class="op">~</span><span class="st"> </span>abund.cov<span class="fl">.1</span>, <span class="dt">det.formula =</span> det.formula, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true"></a>          <span class="dt">data =</span> data.one.sp, <span class="dt">inits =</span> inits, <span class="dt">priors =</span> priors,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true"></a>          <span class="dt">n.batch =</span> n.batch, <span class="dt">batch.length =</span> batch.length, </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true"></a>          <span class="dt">tuning =</span> tuning, <span class="dt">n.omp.threads =</span> <span class="dv">1</span>, </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true"></a>          <span class="dt">family =</span> <span class="st">&#39;NB&#39;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">n.burn =</span> n.burn, </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true"></a>          <span class="dt">n.thin =</span> n.thin, <span class="dt">n.chains =</span> n.chains)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true"></a><span class="co"># Compare models with WAIC</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true"></a><span class="co"># Poisson with abundance random effect</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true"></a><span class="kw">waicAbund</span>(out)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>      elpd         pD       WAIC 
-273.35113   17.14231  580.98690 </code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="co"># Poisson with no abundance random effect</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a><span class="kw">waicAbund</span>(out<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>       elpd          pD        WAIC 
-294.844199    7.282892  604.254183 </code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="co"># NB with abundance random effect</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a><span class="kw">waicAbund</span>(out<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>      elpd         pD       WAIC 
-266.02999   12.14419  556.34837 </code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="co"># NB with no abundance random effect</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a><span class="kw">waicAbund</span>(out<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>       elpd          pD        WAIC 
-276.641961    6.562961  566.409845 </code></pre>
<p>From this simple model comparison exercise, we see two things arise. First, the negative binomial models outperform the Poisson models, indicating there is substantial overdispersion in latent abundance that is not captured by the covariate/random effect included in the model. Second, models with the random effect outperform models without the random effect, indicating it is an important source of variation in abundance across the 225 sites. The best performing model is the model with the random effect and using a negative binomial distribution for latent abundance.</p>
</div>
<div id="prediction" class="section level2">
<h2>Prediction</h2>
<p>All model objects from a call to <code>spAbundance</code> model-fitting functions can be used with <code>predict()</code> to generate a series of posterior predictive samples at new locations, given the values of all covariates used in the model fitting process. Given that we standardized the covariate values when we fit the model, we need to standardize the covariate values for prediction using the exact same values of the mean and standard deviation of the covariate values used to fit the data.</p>
<p>We envision the <code>predict()</code> functions can be used for two purposes: (1) generating marginal effects plots; and (2) predicting across some region of interest. The approach to do the prediction is the same for both purposes. Here we will use the <code>predict()</code> function to generate a marginal effects plot for the effect of the covariate on abundance.</p>
<p>First, we create a set of evenly-spaced values of the covariate across the range of observed values, and subsequently standardize them by the mean and standard deviation of the covariate used to fit the model.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a>cov.pred.vals &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(dataNMixSim<span class="op">$</span>abund.covs[, <span class="st">&#39;abund.cov.1&#39;</span>]), </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a>             <span class="kw">max</span>(dataNMixSim<span class="op">$</span>abund.covs[, <span class="st">&#39;abund.cov.1&#39;</span>]), </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true"></a>                     <span class="dt">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true"></a><span class="co"># Scale predicted values by mean and sd used to fit the model</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true"></a>cov.pred.vals.s &lt;-<span class="st"> </span>(cov.pred.vals <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(dataNMixSim<span class="op">$</span>abund.covs[, <span class="st">&#39;abund.cov.1&#39;</span>])) <span class="op">/</span><span class="st"> </span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true"></a><span class="st">                   </span><span class="kw">sd</span>(dataNMixSim<span class="op">$</span>abund.covs[, <span class="st">&#39;abund.cov.1&#39;</span>])</span></code></pre></div>
<p>For <code>NMix()</code>, the <code>predict()</code> function takes four arguments:</p>
<ol style="list-style-type: decimal">
<li><code>object</code>: the <code>NMix</code> fitted model object.</li>
<li><code>X.0</code>: a matrix or data frame consisting of the design matrix for the prediction locations (which must include an intercept if our model contained one).</li>
<li><code>ignore.RE</code>: a logical value indicating whether or not to remove random effects from the predicted values. By default, this is set to <code>FALSE</code>, and so prediction will include the random effects.</li>
<li><code>type</code>: a quoted keyword indicating whether we want to predict <code>abundance</code> or <code>detection</code>. This is by default set to <code>abundance</code>.</li>
</ol>
<p>Here, we only seek to predict to visualize the relationship between the covariate and abundance, and so we will predict without the random effect and set <code>ignore.RE = TRUE</code>. Thus, our design matrix that we form below only consists of the intercept and covariate value. If we were to predict with the random effect, the random effect values at the prediction location would be included as another column in <code>X.0</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a>X<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">intercept =</span> <span class="dv">1</span>, <span class="dt">abund.cov.1 =</span> cov.pred.vals.s))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a>out.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(out<span class="fl">.3</span>, X<span class="fl">.0</span>, <span class="dt">ignore.RE =</span> <span class="ot">TRUE</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a><span class="kw">str</span>(out.pred)</span></code></pre></div>
<pre><code>List of 3
 $ mu.0.samples: &#39;mcmc&#39; num [1:3000, 1:100] 0.281 0.539 0.307 0.385 0.332 ...
  ..- attr(*, &quot;mcpar&quot;)= num [1:3] 1 3000 1
 $ N.0.samples : &#39;mcmc&#39; num [1:3000, 1:100] 0 0 0 0 0 0 0 0 1 0 ...
  ..- attr(*, &quot;mcpar&quot;)= num [1:3] 1 3000 1
 $ call        : language predict.NMix(object = out.3, X.0 = X.0, ignore.RE = TRUE)
 - attr(*, &quot;class&quot;)= chr &quot;predict.NMix&quot;</code></pre>
<p>The resulting object consists of posterior predictive samples for the expected abundances (<code>mu.0.samples</code>) and latent abundance values (<code>N.0.samples</code>). The beauty of the Bayesian paradigm, and the MCMC computing machinery, is that these predictions all have fully propagated uncertainty. Below, we produce a plot showing the relationship between expected abundance and the covariate, with the 95% credible interval shown in grey and the posterior median shown with the black line.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a><span class="co"># Get the lower bound, median, and 95% credible interval</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a>mu.<span class="fl">0.</span>quants &lt;-<span class="st"> </span><span class="kw">apply</span>(out.pred<span class="op">$</span>mu.<span class="fl">0.</span>samples, <span class="dv">2</span>, quantile, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true"></a>                          <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true"></a>mu.plot.dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">mu.med =</span> mu.<span class="fl">0.</span>quants[<span class="dv">2</span>, ], </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true"></a>                                 <span class="dt">mu.low =</span> mu.<span class="fl">0.</span>quants[<span class="dv">1</span>, ], </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true"></a>                                 <span class="dt">mu.high =</span> mu.<span class="fl">0.</span>quants[<span class="dv">3</span>, ], </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true"></a>                          <span class="dt">abund.cov.1 =</span> cov.pred.vals)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true"></a><span class="kw">ggplot</span>(mu.plot.dat, <span class="kw">aes</span>(<span class="dt">x =</span> abund.cov<span class="fl">.1</span>, <span class="dt">y =</span> mu.med)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mu.low, <span class="dt">ymax =</span> mu.high), <span class="dt">fill =</span> <span class="st">&#39;grey70&#39;</span>) <span class="op">+</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Covariate&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Expected abundance&#39;</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Here we see a moderately positive relationship between the covariate and expected abundance.</p>
</div>
</div>
<div id="spNMix" class="section level1">
<h1>Single-species spatial N-mixture models</h1>
<div id="basic-model-description-1" class="section level2">
<h2>Basic model description</h2>
<p>When working across large spatial domains, accounting for residual spatial autocorrelation in species distributions can often improve predictive performance of a model, leading to more accurate predictions of species abundance patterns <span class="citation">(Guélat and Kéry 2018)</span>. We here extend the basic single-species N-mixture model to incorporate a spatial random effect that accounts for unexplained spatial variation in species abundance across a region of interest. Let <span class="math inline">\(\boldsymbol{s}_j\)</span> denote the geographical coordinates of site <span class="math inline">\(j\)</span> for <span class="math inline">\(j = 1, \dots, J\)</span>. In all spatially-explicit models, we include <span class="math inline">\(\boldsymbol{s}_j\)</span> directly in the notation of spatially-indexed variables to indicate the model is spatially-explicit. More specifically, the expecteda bundance at site <span class="math inline">\(j\)</span> with coordinates <span class="math inline">\(\boldsymbol{s}_j\)</span>, <span class="math inline">\(\mu(\boldsymbol{s}_j)\)</span>, now takes the form</p>
<p><span class="math display">\[\begin{equation}
\text{log}(\mu(\boldsymbol{s}_j) = \textbf{x}(\boldsymbol{s}_j)^{\top}\boldsymbol{\beta} + \text{w}(\boldsymbol{s}_j),
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\text{w}(\boldsymbol{s}_j)\)</span> is a spatial random effect modeled with a Nearest Neighbor Gaussian Process (NNGP; <span class="citation">Datta et al. (2016)</span>). More specifically, we have</p>
<p><span class="math display">\[\begin{equation}
\textbf{w}(\boldsymbol{s}) \sim N(\boldsymbol{0}, \boldsymbol{\tilde{\Sigma}}(\boldsymbol{s}, \boldsymbol{s}&#39;, \boldsymbol{\theta})),
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\tilde{\Sigma}}(\boldsymbol{s}, \boldsymbol{s}&#39;, \boldsymbol{\theta})\)</span> is the NNGP-derived spatial covariance matrix that originates from the full <span class="math inline">\(J \times J\)</span> covariance matrix <span class="math inline">\(\boldsymbol{\Sigma}(\boldsymbol{s}, \boldsymbol{s}&#39;, \boldsymbol{\theta})\)</span> that is a function of the distances between any pair of site coordinates <span class="math inline">\(\boldsymbol{s}\)</span> and <span class="math inline">\(\boldsymbol{s}&#39;\)</span> and a set of parameters <span class="math inline">\((\boldsymbol{\theta})\)</span> that govern the spatial process. The vector <span class="math inline">\(\boldsymbol{\theta}\)</span> is equal to <span class="math inline">\(\boldsymbol{\theta} = \{\sigma^2, \phi, \nu\}\)</span>, where <span class="math inline">\(\sigma^2\)</span> is a spatial variance parameter, <span class="math inline">\(\phi\)</span> is a spatial decay parameter, and <span class="math inline">\(\nu\)</span> is a spatial smoothness parameter. <span class="math inline">\(\nu\)</span> is only specified when using a Matern correlation function. The detection portion of the N-mixture model remains unchanged from the non-spatial N-mixture model. The NNGP is a computationally efficient alternative to working with a full Gaussian process model, which is notoriously slow for even moderately large data sets. See <span class="citation">Datta et al. (2016)</span> and <span class="citation">Finley et al. (2019)</span> for complete statistical details on the NNGP.</p>
</div>
<div id="fitting-single-species-spatial-n-mixture-models-with-spnmix" class="section level2">
<h2>Fitting single-species spatial N-mixture models with <code>spNMix()</code></h2>
<p>We will fit the same N-mixture model that we fit previously using <code>NMix()</code>, but we will now make the model spatially-explicit by incorporating a spatial process with <code>spNMix()</code>. The <code>spNMix()</code> function fits single-species spatial N-mixture models.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a><span class="kw">spNMix</span>(abund.formula, det.formula, data, inits, priors, tuning,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true"></a>       <span class="dt">cov.model =</span> <span class="st">&#39;exponential&#39;</span>, <span class="dt">NNGP =</span> <span class="ot">TRUE</span>, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true"></a>       <span class="dt">n.neighbors =</span> <span class="dv">15</span>, <span class="dt">search.type =</span> <span class="st">&#39;cb&#39;</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true"></a>       n.batch, batch.length, <span class="dt">accept.rate =</span> <span class="fl">0.43</span>, <span class="dt">family =</span> <span class="st">&#39;Poisson&#39;</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true"></a>       <span class="dt">n.omp.threads =</span> <span class="dv">1</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>, <span class="dt">n.report =</span> <span class="dv">100</span>, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true"></a>       <span class="dt">n.burn =</span> <span class="kw">round</span>(.<span class="dv">10</span> <span class="op">*</span><span class="st"> </span>n.batch <span class="op">*</span><span class="st"> </span>batch.length), <span class="dt">n.thin =</span> <span class="dv">1</span>, </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true"></a>       <span class="dt">n.chains =</span> <span class="dv">1</span>, ...)</span></code></pre></div>
<p>The arguments to <code>spNMix()</code> are very similar to those we saw with <code>NMix()</code>, with a few additional components. The abundance (<code>abund.formula</code>) and detection (<code>det.formula</code>) formmulas, as well as the list of data (<code>data</code>), take the same form as we saw in <code>NMix()</code>, with random slopes and intercepts allowed in both the abundance and detection models. Notice the <code>coords</code> matrix in the <code>data.one.sp</code> list of data. We did not use this for <code>NMix()</code>, but specifying the spatial coordinates in <code>data</code> is necessary for all spatially explicit models in <code>spAbundance</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a>abund.formula &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">scale</span>(abund.cov<span class="fl">.1</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>abund.factor<span class="fl">.1</span>) </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a>det.formula &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">scale</span>(det.cov<span class="fl">.1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(det.cov<span class="fl">.2</span>) </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a><span class="kw">str</span>(data.one.sp) <span class="co"># coords is required for spNMix()</span></span></code></pre></div>
<pre><code>List of 4
 $ y         : int [1:225, 1:5] 0 0 1 0 0 0 0 0 0 0 ...
 $ abund.covs: num [1:225, 1:2] 0.2863 -0.0325 -0.9897 0.2118 -0.972 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:2] &quot;abund.cov.1&quot; &quot;abund.factor.1&quot;
 $ det.covs  :List of 2
  ..$ det.cov.1: num [1:225, 1:5] 1.577 0.6956 -0.3031 0.107 0.0284 ...
  ..$ det.cov.2: num [1:225, 1:5] -1.235 -0.509 -2.012 -0.899 0.38 ...
 $ coords    : num [1:225, 1:2] 0 0.0714 0.1429 0.2143 0.2857 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:2] &quot;X&quot; &quot;Y&quot;</code></pre>
<p>The initial values (<code>inits</code>) are again specified in a list. Valid tags for initial values now additionally include the parameters associated with the spatial random effects. These include: <code>sigma.sq</code> (spatial variance parameter), <code>phi</code> (spatial range parameter), <code>w</code> (the latent spatial random effects at each site), and <code>nu</code> (spatial smoothness parameter), where the latter is only specified if adopting a Matern covariance function (i.e., <code>cov.model = &#39;matern&#39;</code>). <code>spAbundance</code> supports four spatial covariance models (<code>exponential</code>, <code>spherical</code>, <code>gaussian</code>, and <code>matern</code>), which are specified in the <code>cov.model</code> argument. Throughout this vignette, we will use an exponential covariance model, which we often use as our default covariance model when fitting spatially-explicit models and is commonly used throughout ecology. To determine which covariance function to use, we can fit models with the different covariance functions and compare them using WAIC to select the best performing function. We will note that the Matern covariance function has the additional spatial smoothness parameter <span class="math inline">\(\nu\)</span> and thus can often be more flexible than the other functions. However, because we need to estimate an additional parameter, this also tends to require more data (i.e., a larger number of sites) than the other covariance functions, and so we encourage use of the three simpler functions if your data set is sparse. We note that model estimates are generally fairly robust to the different covariance functions, although certain functions may provide substantially better estimates depending on the specific form of the underlying spatial autocorrelation in the data. For example, the Gaussian covariance function is often useful for accounting for spatial autocorrelation that is very smooth (i.e., long range spatial dependence). See Chapter 2 in <span class="citation">Banerjee, Carlin, and Gelfand (2003)</span> for a more thorough discussion of these functions and their mathematical properties.</p>
<p>The default initial values for <code>phi</code>, and <code>nu</code> are set to random values from the prior distribution, while the default initial value for <code>sigma.sq</code> is set to a random value between 0.05 and 3. In all spatially-explicit models described in this vignette, the spatial decay parameter <code>phi</code> is often the most sensitive to initial values. In general, the spatial decay parameter will often have poor mixing and take longer to converge than the rest of the parameters in the model, so specifying an initial value that is reasonably close to the resulting value can really help decrease run times for complicated models. As an initial value for the spatial decay parameter <code>phi</code>, we compute the mean distance between points in our coordinates matrix and then set it equal to 3 divided by this mean distance. When using an exponential covariance function, <span class="math inline">\(\frac{3}{\phi}\)</span> is the effective range, or the distance at which the residual spatial correlation between two sites drops to 0.05 <span class="citation">(Banerjee, Carlin, and Gelfand 2003)</span>. Thus our initial guess for this effective range is the average distance between sites across the simulated region. As with all other parameters, we generally recommend using the default initial values for an initial model run, and if the model is taking a very long time to converge you can rerun the model with initial values based on the posterior means of estimated parameters from the initial model fit. For the spatial variance parameter <code>sigma.sq</code>, we set the initial value to 1. This corresponds to a moderate amount of spatial variance. Further, we set the initial values of the latent spatial random effects at each site to 0. The initial values for these random effects has an extremely small influence on the model results, so we generally recommend setting their initial values to 0 as we have done here (this is also the default). However, if you are running your model for a very long time and are seeing very slow convergence of the MCMC chains, setting the initial values of the spatial random effects to the mean estimates from a previous run of the model could help reach convergence faster.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a><span class="co"># Pair-wise distances between all sites</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a>dist.mat &lt;-<span class="st"> </span><span class="kw">dist</span>(data.one.sp<span class="op">$</span>coords)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true"></a><span class="co"># Exponential covariance model</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true"></a>cov.model &lt;-<span class="st"> &#39;exponential&#39;</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true"></a><span class="co"># Specify list of inits</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true"></a>inits &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">0</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true"></a>              <span class="dt">beta =</span> <span class="dv">0</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true"></a>              <span class="dt">kappa =</span> <span class="fl">0.5</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true"></a>          <span class="dt">sigma.sq.mu =</span> <span class="fl">0.5</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true"></a>              <span class="dt">N =</span> <span class="kw">apply</span>(data.one.sp<span class="op">$</span>y, <span class="dv">1</span>, max, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true"></a>              <span class="dt">sigma.sq =</span> <span class="dv">1</span>, </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true"></a>          <span class="dt">phi =</span> <span class="dv">3</span> <span class="op">/</span><span class="st"> </span><span class="kw">mean</span>(dist.mat),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true"></a>          <span class="dt">w =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(data.one.sp<span class="op">$</span>y)))</span></code></pre></div>
<p>The parameter <code>NNGP</code> is a logical value that specifies whether we want to use an NNGP to fit the model. Currently, only <code>NNGP = TRUE</code> is supported, but we may eventually add functionality to fit full Gaussian Process models. The arguments <code>n.neighbors</code> and <code>search.type</code> specify the number of neighbors used in the NNGP and the nearest neighbor search algorithm, respectively, to use for the NNGP model. Generally, the default values of these arguments will be adequate. <span class="citation">Datta et al. (2016)</span> showed that setting <code>n.neighbors = 15</code> is usually sufficient, although for certain data sets a good approximation can be achieved with as few as five neighbors, which could substantially decrease run time for the model. We generally recommend leaving <code>search.type = &quot;cb&quot;</code>, as this results in a fast code book nearest neighbor search algorithm. However, details on when you may want to change this are described in <span class="citation">Finley, Datta, and Banerjee (2020)</span>. We will run an NNGP model using the default value for <code>search.type</code> and setting <code>n.neighbors = 15</code> (both the defaults).</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true"></a>NNGP &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true"></a>n.neighbors &lt;-<span class="st"> </span><span class="dv">15</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true"></a>search.type &lt;-<span class="st"> &#39;cb&#39;</span></span></code></pre></div>
<p>Priors are again specified in a list in the argument <code>priors</code>. We follow standard recommendations for prior distributions from the spatial statistics literature <span class="citation">(Banerjee, Carlin, and Gelfand 2003)</span>. We assume an inverse gamma prior for the spatial variance parameter <code>sigma.sq</code> (the tag of which is <code>sigma.sq.ig</code>), and uniform priors for the spatial decay parameter <code>phi</code> and smoothness parameter <code>nu</code> (if using the Matern correlation function), with the associated tags <code>phi.unif</code> and <code>nu.unif</code>. The hyperparameters of the inverse Gamma are passed as a vector of length two, with the first and second elements corresponding to the shape and scale, respectively. The lower and upper bounds of the uniform distribution are passed as a two-element vector for the uniform priors. We also allow users to restrict the spatial variance further by specifying a uniform prior (with the tag <code>sigma.sq.unif</code>), which can potentially be useful to place a more informative prior on the spatial parameters. Generally, we use an inverse-Gamma prior.</p>
<p>Note that the priors for the spatial parameters in a spatially-explicit model must be at least weakly informative for the model to converge <span class="citation">(Banerjee, Carlin, and Gelfand 2003)</span>. For the inverse-Gamma prior on the spatial variance, we typically set the shape parameter to 2 and the scale parameter equal to our best guess of the spatial variance. The default prior hyperparameter values for the spatial variance <span class="math inline">\(\sigma^2\)</span> are a shape parameter of 2 and a scale parameter of 1. This weakly informative prior suggests a prior mean of 1 for the spatial variance, which is a moderately small amount of spatial variation. Here we will use this default prior. For the spatial decay parameter, our default approach is to set the lower and upper bounds of the uniform prior based on the minimum and maximum distances between sites in the data. More specifically, by default we set the lower bound to <code>3 / max</code> and the upper bound to <code>3 / min</code>, where <code>min</code> and <code>max</code> are the minimum and maximum distances between sites in the data set, respectively. This equates to a vague prior that states the spatial autocorrelation in the data could only exist between sites that are very close together, or could span across the entire observed study area. If additional information is known on the extent of the spatial autocorrelation in the data, you may place more restrictive bounds on the uniform prior, which would reduce the amount of time needed for adequate mixing and convergence of the MCMC chains. Here we use this default approach, but will explicitly set the values for transparency.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a>min.dist &lt;-<span class="st"> </span><span class="kw">min</span>(dist.mat)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true"></a>max.dist &lt;-<span class="st"> </span><span class="kw">max</span>(dist.mat)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true"></a>priors &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">alpha.normal =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">var =</span> <span class="fl">2.72</span>),</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true"></a>               <span class="dt">beta.normal =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">var =</span> <span class="dv">100</span>), </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true"></a>               <span class="dt">kappa.unif =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true"></a>               <span class="dt">sigma.sq.mu.ig =</span> <span class="kw">list</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>), </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true"></a>           <span class="dt">sigma.sq.ig =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true"></a>           <span class="dt">phi.unif =</span> <span class="kw">c</span>(<span class="dv">3</span> <span class="op">/</span><span class="st"> </span>max.dist, <span class="dv">3</span> <span class="op">/</span><span class="st"> </span>min.dist))</span></code></pre></div>
<p>We again split our MCMC algorithm up into a set of batches and use an adaptive sampler to adaptively tune the variances that we propose new values from. We specify the initial tuning values again in the <code>tuning</code> argument, and now need to add <code>phi</code> and <code>w</code> to the parameters that must be tuned. Note that we do not need to add <code>sigma.sq</code>, as this parameter can be sampled with a more efficient approach (i.e., it’s full conditional distribution is available in closed form).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a>tuning &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">beta =</span> <span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">kappa =</span> <span class="fl">0.5</span>, <span class="dt">beta.star =</span> <span class="fl">0.5</span>, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a>               <span class="dt">w =</span> <span class="fl">0.5</span>, <span class="dt">phi =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p>The argument <code>n.omp.threads</code> specifies the number of threads to use for within-chain parallelization, while <code>verbose</code> specifies whether or not to print the progress of the sampler. As before, the argument <code>n.report</code> specifies the interval to report the Metropolis-Hastings sampler acceptance rate. Below we set <code>n.report = 100</code>, which will result in information on the acceptance rate and tuning parameters every 100th batch.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a>verbose &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true"></a>batch.length &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true"></a>n.batch &lt;-<span class="st"> </span><span class="dv">800</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true"></a><span class="co"># Total number of MCMC samples per chain</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true"></a>batch.length <span class="op">*</span><span class="st"> </span>n.batch</span></code></pre></div>
<pre><code>[1] 20000</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a>n.report &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true"></a>n.omp.threads &lt;-<span class="st"> </span><span class="dv">1</span></span></code></pre></div>
<p>We will use the same amount of burn-in and thinning as we did with the non-spatial model, and we’ll also first fit a model with a Poisson distribution for abundance. We next fit the model and summarize the results using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true"></a>n.burn &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true"></a>n.thin &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true"></a>n.chains &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true"></a>out.sp &lt;-<span class="st"> </span><span class="kw">spNMix</span>(<span class="dt">abund.formula =</span> abund.formula, </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true"></a>             <span class="dt">det.formula =</span> det.formula, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true"></a>             <span class="dt">data =</span> data.one.sp, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true"></a>             <span class="dt">inits =</span> inits, </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true"></a>             <span class="dt">priors =</span> priors,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true"></a>             <span class="dt">n.batch =</span> n.batch,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true"></a>             <span class="dt">batch.length =</span> batch.length, </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true"></a>             <span class="dt">tuning =</span> tuning, </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true"></a>         <span class="dt">cov.model =</span> cov.model,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true"></a>         <span class="dt">NNGP =</span> NNGP, </span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true"></a>         <span class="dt">n.neighbors =</span> n.neighbors,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true"></a>         <span class="dt">search.type =</span> search.type,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true"></a>             <span class="dt">n.omp.threads =</span> n.omp.threads,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true"></a>             <span class="dt">n.report =</span> n.report,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true"></a>             <span class="dt">family =</span> <span class="st">&#39;Poisson&#39;</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true"></a>             <span class="dt">verbose =</span> <span class="ot">TRUE</span>,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true"></a>             <span class="dt">n.burn =</span> n.burn,</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true"></a>             <span class="dt">n.thin =</span> n.thin, </span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true"></a>             <span class="dt">n.chains =</span> n.chains)</span></code></pre></div>
<pre><code>----------------------------------------
    Preparing to run the model
----------------------------------------
----------------------------------------
    Building the neighbor list
----------------------------------------
----------------------------------------
Building the neighbors of neighbors list
----------------------------------------
----------------------------------------
    Model description
----------------------------------------
Spatial NNGP Poisson N-mixture model with 225 sites.

Samples per Chain: 20000 (800 batches of length 25)
Burn-in: 10000 
Thinning Rate: 10 
Number of Chains: 3 
Total Posterior Samples: 3000 

Using the exponential spatial correlation model.

Using 15 nearest neighbors.

Source compiled with OpenMP support and model fit using 1 thread(s).

Adaptive Metropolis with target acceptance rate: 43.0
----------------------------------------
    Chain 1
----------------------------------------
Sampling ... 
Batch: 100 of 800, 12.50%
    Parameter   Acceptance  Tuning
    beta[1]     24.0        0.26630
    beta[2]     36.0        0.29430
    alpha[1]    32.0        0.35234
    alpha[2]    36.0        0.49502
    alpha[3]    52.0        0.35234
    phi     40.0        0.53625
-------------------------------------------------
Batch: 200 of 800, 25.00%
    Parameter   Acceptance  Tuning
    beta[1]     48.0        0.25585
    beta[2]     48.0        0.27716
    alpha[1]    32.0        0.32525
    alpha[2]    56.0        0.51523
    alpha[3]    44.0        0.36672
    phi     48.0        0.54709
-------------------------------------------------
Batch: 300 of 800, 37.50%
    Parameter   Acceptance  Tuning
    beta[1]     40.0        0.24095
    beta[2]     44.0        0.25585
    alpha[1]    60.0        0.34537
    alpha[2]    20.0        0.55814
    alpha[3]    56.0        0.35234
    phi     28.0        0.60462
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Parameter   Acceptance  Tuning
    beta[1]     36.0        0.24095
    beta[2]     48.0        0.26630
    alpha[1]    56.0        0.34537
    alpha[2]    44.0        0.54709
    alpha[3]    48.0        0.35234
    phi     28.0        0.54709
-------------------------------------------------
Batch: 500 of 800, 62.50%
    Parameter   Acceptance  Tuning
    beta[1]     36.0        0.23618
    beta[2]     40.0        0.26102
    alpha[1]    40.0        0.36672
    alpha[2]    40.0        0.48522
    alpha[3]    44.0        0.35234
    phi     28.0        0.54709
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Parameter   Acceptance  Tuning
    beta[1]     44.0        0.26102
    beta[2]     24.0        0.26102
    alpha[1]    60.0        0.36672
    alpha[2]    52.0        0.52564
    alpha[3]    64.0        0.37413
    phi     44.0        0.52564
-------------------------------------------------
Batch: 700 of 800, 87.50%
    Parameter   Acceptance  Tuning
    beta[1]     44.0        0.25585
    beta[2]     52.0        0.24095
    alpha[1]    40.0        0.33853
    alpha[2]    32.0        0.52564
    alpha[3]    52.0        0.33853
    phi     24.0        0.62930
-------------------------------------------------
Batch: 800 of 800, 100.00%
----------------------------------------
    Chain 2
----------------------------------------
Sampling ... 
Batch: 100 of 800, 12.50%
    Parameter   Acceptance  Tuning
    beta[1]     72.0        0.24582
    beta[2]     48.0        0.25585
    alpha[1]    60.0        0.35946
    alpha[2]    40.0        0.50503
    alpha[3]    48.0        0.32525
    phi     52.0        0.56941
-------------------------------------------------
Batch: 200 of 800, 25.00%
    Parameter   Acceptance  Tuning
    beta[1]     48.0        0.26102
    beta[2]     44.0        0.26102
    alpha[1]    52.0        0.33853
    alpha[2]    24.0        0.54709
    alpha[3]    28.0        0.33183
    phi     28.0        0.54709
-------------------------------------------------
Batch: 300 of 800, 37.50%
    Parameter   Acceptance  Tuning
    beta[1]     44.0        0.25079
    beta[2]     44.0        0.26102
    alpha[1]    44.0        0.35946
    alpha[2]    28.0        0.55814
    alpha[3]    40.0        0.37413
    phi     64.0        0.54709
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Parameter   Acceptance  Tuning
    beta[1]     28.0        0.24582
    beta[2]     40.0        0.25585
    alpha[1]    36.0        0.36672
    alpha[2]    48.0        0.52564
    alpha[3]    64.0        0.33183
    phi     44.0        0.47561
-------------------------------------------------
Batch: 500 of 800, 62.50%
    Parameter   Acceptance  Tuning
    beta[1]     36.0        0.23618
    beta[2]     52.0        0.26630
    alpha[1]    24.0        0.37413
    alpha[2]    48.0        0.53625
    alpha[3]    40.0        0.37413
    phi     32.0        0.46620
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Parameter   Acceptance  Tuning
    beta[1]     44.0        0.24582
    beta[2]     32.0        0.26102
    alpha[1]    40.0        0.33853
    alpha[2]    44.0        0.48522
    alpha[3]    48.0        0.34537
    phi     40.0        0.50503
-------------------------------------------------
Batch: 700 of 800, 87.50%
    Parameter   Acceptance  Tuning
    beta[1]     44.0        0.26102
    beta[2]     40.0        0.23618
    alpha[1]    60.0        0.35946
    alpha[2]    44.0        0.55814
    alpha[3]    44.0        0.35234
    phi     44.0        0.53625
-------------------------------------------------
Batch: 800 of 800, 100.00%
----------------------------------------
    Chain 3
----------------------------------------
Sampling ... 
Batch: 100 of 800, 12.50%
    Parameter   Acceptance  Tuning
    beta[1]     52.0        0.25079
    beta[2]     36.0        0.25079
    alpha[1]    32.0        0.35234
    alpha[2]    44.0        0.50503
    alpha[3]    40.0        0.34537
    phi     52.0        0.58092
-------------------------------------------------
Batch: 200 of 800, 25.00%
    Parameter   Acceptance  Tuning
    beta[1]     40.0        0.24095
    beta[2]     36.0        0.26102
    alpha[1]    36.0        0.34537
    alpha[2]    52.0        0.52564
    alpha[3]    36.0        0.34537
    phi     40.0        0.54709
-------------------------------------------------
Batch: 300 of 800, 37.50%
    Parameter   Acceptance  Tuning
    beta[1]     52.0        0.26102
    beta[2]     56.0        0.26630
    alpha[1]    60.0        0.34537
    alpha[2]    44.0        0.53625
    alpha[3]    48.0        0.35234
    phi     52.0        0.55814
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Parameter   Acceptance  Tuning
    beta[1]     36.0        0.24582
    beta[2]     48.0        0.26102
    alpha[1]    36.0        0.37413
    alpha[2]    24.0        0.51523
    alpha[3]    48.0        0.33853
    phi     44.0        0.56941
-------------------------------------------------
Batch: 500 of 800, 62.50%
    Parameter   Acceptance  Tuning
    beta[1]     60.0        0.24095
    beta[2]     52.0        0.23618
    alpha[1]    56.0        0.36672
    alpha[2]    48.0        0.52564
    alpha[3]    40.0        0.37413
    phi     36.0        0.55814
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Parameter   Acceptance  Tuning
    beta[1]     40.0        0.25079
    beta[2]     40.0        0.24582
    alpha[1]    32.0        0.34537
    alpha[2]    32.0        0.51523
    alpha[3]    32.0        0.36672
    phi     52.0        0.59265
-------------------------------------------------
Batch: 700 of 800, 87.50%
    Parameter   Acceptance  Tuning
    beta[1]     40.0        0.24095
    beta[2]     32.0        0.26102
    alpha[1]    52.0        0.35946
    alpha[2]    44.0        0.51523
    alpha[3]    52.0        0.35946
    phi     64.0        0.60462
-------------------------------------------------
Batch: 800 of 800, 100.00%</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true"></a><span class="kw">summary</span>(out.sp)</span></code></pre></div>
<pre><code>
Call:
spNMix(abund.formula = abund.formula, det.formula = det.formula, 
    data = data.one.sp, inits = inits, priors = priors, tuning = tuning, 
    cov.model = cov.model, NNGP = NNGP, n.neighbors = n.neighbors, 
    search.type = search.type, n.batch = n.batch, batch.length = batch.length, 
    family = &quot;Poisson&quot;, n.omp.threads = n.omp.threads, verbose = TRUE, 
    n.report = n.report, n.burn = n.burn, n.thin = n.thin, n.chains = n.chains)

Samples per Chain: 20000
Burn-in: 10000
Thinning Rate: 10
Number of Chains: 3
Total Posterior Samples: 3000
Run Time (min): 3.4701

Abundance (log scale): 
                      Mean     SD    2.5%     50%   97.5%   Rhat  ESS
(Intercept)        -1.4470 0.3814 -2.1518 -1.4673 -0.6516 1.0878  138
scale(abund.cov.1)  0.0444 0.1358 -0.2110  0.0456  0.3193 1.0003 1679

Abundance Random Effect Variances (log scale): 
                             Mean     SD   2.5%    50%  97.5%   Rhat  ESS
(Intercept)-abund.factor.1 0.4899 0.5103 0.0825 0.3558 1.6413 1.0557 1211

Detection (logit scale): 
                    Mean     SD    2.5%     50%  97.5%   Rhat  ESS
(Intercept)       0.8123 0.2075  0.4237  0.8133 1.2162 0.9997 1144
scale(det.cov.1)  1.9357 0.2567  1.4669  1.9246 2.4674 1.0038 1944
scale(det.cov.2) -0.0311 0.1561 -0.3343 -0.0294 0.2657 1.0066 2190

Spatial Covariance: 
            Mean     SD   2.5%    50%   97.5%   Rhat ESS
sigma.sq  1.1469 0.4405 0.4803 1.0862  2.1896 1.0769 306
phi      12.0245 7.9270 3.1093 9.6791 35.3313 1.0727 120</code></pre>
<p>Looking at the model summary we see adequate convergence of all model parameters. The <code>summary()</code> output looks the same as what we saw previously, with the additional section titled “Spatial Covariance”. There we see the estimate of the spatial variance (<code>sigma.sq</code>) and spatial decay (<code>phi</code>) parameters. The spatial variance is near 1, which indicates substantial spatial variability in abundance across space. Interpretation of the spatial variance parameter can follow interpretation of variance parameters in “regular” (i.e., unstructured) random effect variances: when the variance is close to 0, that indicates little support for inclusion of the spatial random effect. When the variance is large, it indicates substantial support for the spatial random effect. What indicates “large” vs. “small” isn’t necessarily straightforward, but here the estimate is clearly above 1, which is a substantially large variance parameter on the log scale. We can also look at the magnitude of the spatial random effect estimates themselves to give an indication as to how much residual spatial autocorrelation there is in the abundance estimates. The posterior samples for the spatial random effects are stored in <code>w.samples</code> tag of the resulting model fit list. Here we calculate the means of the spatial random effects and plot a histogram of their values.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a>w.means &lt;-<span class="st"> </span><span class="kw">apply</span>(out.sp<span class="op">$</span>w.samples, <span class="dv">2</span>, mean)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true"></a><span class="kw">hist</span>(w.means)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We see a fair amount of large magnitude random effect values, both above and below zero. If there was limited support for spatial autocorrelation, these values would all be very close to zero.</p>
</div>
<div id="posterior-predictive-checks-1" class="section level2">
<h2>Posterior predictive checks</h2>
<p>Posterior predictive checks proceed exactly before using the <code>ppcAbund()</code> function.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true"></a>ppc.out.sp &lt;-<span class="st"> </span><span class="kw">ppcAbund</span>(out.sp, <span class="dt">fit.stat =</span> <span class="st">&#39;freeman-tukey&#39;</span>, <span class="dt">group =</span> <span class="dv">1</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true"></a><span class="kw">summary</span>(ppc.out.sp)</span></code></pre></div>
<pre><code>
Call:
ppcAbund(object = out.sp, fit.stat = &quot;freeman-tukey&quot;, group = 1)

Samples per Chain: 20000
Burn-in: 10000
Thinning Rate: 10
Number of Chains: 3
Total Posterior Samples: 3000

Bayesian p-value:  0.5237 
Fit statistic:  freeman-tukey </code></pre>
</div>
<div id="model-selection-using-waic-1" class="section level2">
<h2>Model selection using WAIC</h2>
<p>We next compare the spatial Poisson N-mixture model to the best performing non-spatial N-mixture model, which used a negative binomial distribution (stored in <code>out.3</code>).</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a><span class="co"># Negative binomial non-spatial model</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true"></a><span class="kw">waicAbund</span>(out<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>      elpd         pD       WAIC 
-266.02999   12.14419  556.34837 </code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a><span class="co"># Poisson spatial model</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true"></a><span class="kw">waicAbund</span>(out.sp)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>      elpd         pD       WAIC 
-223.40196   41.46974  529.74339 </code></pre>
<p>Here we see the spatial Poisson model outperforms the negative binomial non-spatial model. Both of these models can be viewed as a “standard” N-mixture model that account for overdispersion in two different ways: the negative binomial model has a parameter <code>kappa</code> that controls the amount of overdispersion, which is not assumed to have any spatial structure, while the spatial Poisson model can be thought of as a Poisson-lognormal model, where the log-normal random effects are assigned a spatial structure. Here, the latter model does a more adequate job of accounting for overdispersion in the latent abundance values. We could also fit a spatial negative binomial model, which essentially includes two mechanisms to account for overdispersion. We leave this to the interested reader to fit this model and see how it compares for this data set. We will note that spatial negative binomial models can sometimes be difficult to fit. This is particularly the case when there is no medium to large range spatial autocorrelation in the abundance values. When this is the case, the spatial random effects will be very difficult to identify from the negative binomial overdispersion parameter, and we may seem some unidentifiability occurring between the negative binomial overdispersion parameter and the parameters controlling the spatial dependence. In such a case, a spatial Poisson model or a negative binomial non-spatial model will usually suffice. Alternatively, we could set an informative prior on the spatial range to only allow the spatial random effects to explain high-range spatial autocorrelation and let the negative binomial overdispersion parameter account for short range overdispersion. We could then compare that model to simpler versions of the model using WAIC.</p>
</div>
<div id="prediction-1" class="section level2">
<h2>Prediction</h2>
<p>We can similarly predict across a region of interest using the <code>predict()</code> function as we saw with the non-spatial N-mixture model. Here we again generate a marginal effects plot for the effect of the covariate on abundance. When generating a marginal effects plot, we set the <code>include.sp</code> argument to <code>FALSE</code>, which means that we will generate predictions only used the covariates, their effects, and any unstructured random effects included in the model. We generally only recommend doing this if the goal is to produce a marginal effects plot, as the inclusion of the spatial random effects often drastically improves model predictive performance when interest lies in predicting at new regions. See <code>?predict.spNMix</code> for an example of predicting abundance at a set of new locations.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a><span class="co"># Recall what the prediction design matrix looks like</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true"></a><span class="kw">str</span>(X<span class="fl">.0</span>)</span></code></pre></div>
<pre><code> num [1:100, 1:2] 1 1 1 1 1 1 1 1 1 1 ...
 - attr(*, &quot;dimnames&quot;)=List of 2
  ..$ : NULL
  ..$ : chr [1:2] &quot;intercept&quot; &quot;abund.cov.1&quot;</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true"></a>out.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(out.sp, X<span class="fl">.0</span>, <span class="dt">ignore.RE =</span> <span class="ot">TRUE</span>, <span class="dt">include.sp =</span> <span class="ot">FALSE</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true"></a><span class="kw">str</span>(out.pred)</span></code></pre></div>
<pre><code>List of 3
 $ mu.0.samples: &#39;mcmc&#39; num [1:3000, 1:100] 0.254 0.218 0.181 0.348 0.25 ...
  ..- attr(*, &quot;mcpar&quot;)= num [1:3] 1 3000 1
 $ N.0.samples : &#39;mcmc&#39; int [1:3000, 1:100] 1 0 0 0 0 2 1 0 1 0 ...
  ..- attr(*, &quot;mcpar&quot;)= num [1:3] 1 3000 1
 $ call        : language predict.spNMix(object = out.sp, X.0 = X.0, ignore.RE = TRUE, include.sp = FALSE)
 - attr(*, &quot;class&quot;)= chr &quot;predict.spNMix&quot;</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true"></a><span class="co"># Get the lower bound, median, and 95% credible interval</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true"></a>mu.<span class="fl">0.</span>quants &lt;-<span class="st"> </span><span class="kw">apply</span>(out.pred<span class="op">$</span>mu.<span class="fl">0.</span>samples, <span class="dv">2</span>, quantile,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true"></a>                          <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true"></a>mu.plot.dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">mu.med =</span> mu.<span class="fl">0.</span>quants[<span class="dv">2</span>, ],</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true"></a>                                 <span class="dt">mu.low =</span> mu.<span class="fl">0.</span>quants[<span class="dv">1</span>, ],</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true"></a>                                 <span class="dt">mu.high =</span> mu.<span class="fl">0.</span>quants[<span class="dv">3</span>, ],</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true"></a>                          <span class="dt">abund.cov.1 =</span> cov.pred.vals)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true"></a><span class="kw">ggplot</span>(mu.plot.dat, <span class="kw">aes</span>(<span class="dt">x =</span> abund.cov<span class="fl">.1</span>, <span class="dt">y =</span> mu.med)) <span class="op">+</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mu.low, <span class="dt">ymax =</span> mu.high), <span class="dt">fill =</span> <span class="st">&#39;grey70&#39;</span>) <span class="op">+</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Covariate&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Expected abundance&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multi-species-n-mixture-models" class="section level1">
<h1>Multi-species N-mixture models</h1>
<div id="basic-model-description-2" class="section level2">
<h2>Basic model description</h2>
<p>Now consider the case where repeated count data, <span class="math inline">\(y_{i, j, k}\)</span>, are collected for multiple species <span class="math inline">\(i = 1, \dots, I\)</span> at each survey location <span class="math inline">\(j\)</span> during survey <span class="math inline">\(k\)</span>. We are now interested in estimating the abundance of each species <span class="math inline">\(i\)</span> at each location <span class="math inline">\(j\)</span>, denoted as <span class="math inline">\(N_{i, j}\)</span>. We model <span class="math inline">\(N_{i, j}\)</span> analogous to the single-species N-mixture model, with expected abundance now varying by species and site according to</p>
<p><span class="math display">\[\begin{equation}\label{mu-msNMix}
     \text{log}(\mu_{i, j}) = \textbf{x}_j)^\top\boldsymbol{\beta}_i,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\beta}_i\)</span> are the species-specific effects of covariates <span class="math inline">\(\textbf{x}_j\)</span> (including an intercept) . When <span class="math inline">\(N_i(\boldsymbol{s}_j)\)</span> is modeled using a negative binomial distribution, we estimate a separate dispersion parameter <span class="math inline">\(\kappa_i\)</span> for each species. We model <span class="math inline">\(\boldsymbol{\beta}_i\)</span> as random effects arising from a common, community-level normal distribution, which leads to increased precision of species-specific effects compared to single-species models <span class="citation">(Yamaura et al. 2012)</span>. For example, the species-specific abundance intercept <span class="math inline">\(\beta0_i\)</span> is modeled according to</p>
<p><span class="math display">\[\begin{equation}\label{betaComm}
     \beta0_i \sim \text{Normal}(\mu_{\beta0}, \tau^2_{\beta0}),
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mu_{\beta0}\)</span> is the community-level abundance intercept, and <span class="math inline">\(\tau^2_{\beta0}\)</span> is the variance of the intercept across all <span class="math inline">\(I\)</span> species. The observation portion of the multi-species N-mixture model is identical to the single-species model, with all parameters indexed by species, and the species-specific coefficients <span class="math inline">\(\boldsymbol{\alpha}_i\)</span> modeled hierarchically analogous to the species-specific abundance coefficients just described.</p>
<p>We assign normal priors to the community-level abundance (<span class="math inline">\(\boldsymbol{\mu}_{\beta}\)</span>) and detection (<span class="math inline">\(\boldsymbol{\mu}_{\alpha}\)</span>) mean parameters and inverse-Gamma priors to the community-level variance parameters (<span class="math inline">\(\boldsymbol{\tau^2}_{\beta}\)</span> and <span class="math inline">\(\boldsymbol{\tau^2}_{\alpha}\)</span>).</p>
</div>
<div id="fitting-multi-species-n-mixture-models-with-msnmix" class="section level2">
<h2>Fitting multi-species N-mixture models with <code>msNMix()</code></h2>
<p><code>spAbundance</code> uses nearly identical syntax for fitting multi-species N-mixture models as it does for single-species models and provides the same functionality for posterior predictive checks, model assessment and selection using WAIC, and prediction. The <code>msNMix()</code> function fits the multi-species N-mixture model first introduced by <span class="citation">Yamaura et al. (2012)</span>. <code>msNMix()</code> has the following syntax</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a><span class="kw">msNMix</span>(abund.formula, det.formula, data, inits, priors,  </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true"></a>       tuning, n.batch, batch.length, <span class="dt">accept.rate =</span> <span class="fl">0.43</span>, </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true"></a>       <span class="dt">family =</span> <span class="st">&#39;Poisson&#39;</span>, <span class="dt">n.omp.threads =</span> <span class="dv">1</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>, <span class="dt">n.report =</span> <span class="dv">100</span>, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true"></a>       <span class="dt">n.burn =</span> <span class="kw">round</span>(.<span class="dv">10</span> <span class="op">*</span><span class="st"> </span>n.samples), <span class="dt">n.thin =</span> <span class="dv">1</span>, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true"></a>       <span class="dt">n.chains =</span> <span class="dv">1</span>, ...)</span></code></pre></div>
<p>Notice these are the exact same arguments we saw with <code>NMix()</code>. We will again use our simulated data set contained in <code>dataNMixSim</code>, but now we will use data from all 6 species in the simulated community. Below we reload the <code>dataNMixSim</code> data set to get a fresh copy.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true"></a><span class="kw">data</span>(dataNMixSim)</span></code></pre></div>
<p>We will model abundance for all species as a function of the continuous covariate and a random effect of the categorical variable, as well as the two continuous covariates for detection probability. For multi-species models, the multi-species detection-nondetection data <code>y</code> is now a three-dimensional array with dimensions corresponding to species, sites, and replicates. This is how the data are provided in the <code>dataNMixSim</code> object, so we don’t need to do any additional preparations. For guidance on preparing raw data into such a three-dimensional array format, please see <a href="https://www.jeffdoser.com/files/spoccupancy-web/articles/dataformatting">this vignette on the <code>spOccupancy</code> website</a>, which while providing guidance for fitting multi-species models in <code>spOccupancy</code>, the format for <code>spAbundance</code> is exactly the same and all the same guidance applies here.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a>abund.ms.formula &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">scale</span>(abund.cov<span class="fl">.1</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>abund.factor<span class="fl">.1</span>) </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true"></a>det.ms.formula &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">scale</span>(det.cov<span class="fl">.1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(det.cov<span class="fl">.2</span>) </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true"></a><span class="kw">str</span>(dataNMixSim)</span></code></pre></div>
<pre><code>List of 4
 $ y         : int [1:6, 1:225, 1:5] 0 0 1 0 0 0 0 0 0 0 ...
 $ abund.covs: num [1:225, 1:2] 0.2863 -0.0325 -0.9897 0.2118 -0.972 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:2] &quot;abund.cov.1&quot; &quot;abund.factor.1&quot;
 $ det.covs  :List of 2
  ..$ det.cov.1: num [1:225, 1:5] 1.577 0.6956 -0.3031 0.107 0.0284 ...
  ..$ det.cov.2: num [1:225, 1:5] -1.235 -0.509 -2.012 -0.899 0.38 ...
 $ coords    : num [1:225, 1:2] 0 0.0714 0.1429 0.2143 0.2857 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:2] &quot;X&quot; &quot;Y&quot;</code></pre>
<p>Next we specify the initial values in <code>inits</code>. For multi-species N-mixture models, we supply initial values for community-level and species-level parameters. In <code>msNMix()</code>, we will supply initial values for the following parameters: <code>alpha.comm</code> (community-level detection coefficients), <code>beta.comm</code> (community-level abundance coefficients), <code>alpha</code> (species-level detection coefficients), <code>beta</code> (species-level abundance coefficients), <code>tau.sq.beta</code> (community-level abundance variance parameters), <code>tau.sq.alpha</code> (community-level detection variance parameters, <code>N</code> (latent abundance variables for all species), <code>kappa</code> (species-level negative binomial overdispersion parameters), <code>sigma.sq.mu</code> (random effect variances for abundance), and <code>sigma.sq.p</code> (random effect variances for detection). These are all specified in a single list. Initial values for community-level parameters (including the random effect variances) are either vectors of length corresponding to the number of community-level detection or occurrence parameters in the model (including the intercepts) or a single value if all parameters are assigned the same initial values. Initial values for species level parameters are either matrices with the number of rows indicating the number of species, and each column corresponding to a different regression parameter, or a single value if the same initial value is used for all species and parameters. The initial values for the latent abundance matrix are specified as a matrix with <span class="math inline">\(N\)</span> rows corresponding to the number of species and <span class="math inline">\(J\)</span> columns corresponding to the number of sites.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="co"># Number of species</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a>n.sp &lt;-<span class="st"> </span><span class="kw">dim</span>(dataNMixSim<span class="op">$</span>y)[<span class="dv">1</span>]</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true"></a>ms.inits &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">alpha.comm =</span> <span class="dv">0</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true"></a>                 <span class="dt">beta.comm =</span> <span class="dv">0</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true"></a>                 <span class="dt">beta =</span> <span class="dv">0</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true"></a>                 <span class="dt">alpha =</span> <span class="dv">0</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true"></a>                 <span class="dt">tau.sq.beta =</span> <span class="dv">1</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true"></a>         <span class="dt">kappa =</span> <span class="dv">1</span>,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true"></a>                 <span class="dt">tau.sq.alpha =</span> <span class="dv">1</span>,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true"></a>         <span class="dt">sigma.sq.mu =</span> <span class="fl">0.5</span>,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true"></a>                 <span class="dt">N =</span> <span class="kw">apply</span>(dataNMixSim<span class="op">$</span>y, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), max, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<p>In multi-species models, we specify priors on the community-level coefficients (or hyperparameters) rather than the species-level effects, with the exception that we still assign uniform priors for the negative binomial overdispersion parameter. For nonspatial models, these priors are specified with the following tags: <code>beta.comm.normal</code> (normal prior on the community-level abundance mean effects), <code>alpha.comm.normal</code> (normal prior on the community-level detection mean effects), <code>tau.sq.beta.ig</code> (inverse-Gamma prior on the community-level abundance variance parameters), <code>tau.sq.alpha.ig</code> (inverse-Gamma prior on the community-level detection variance parameters), <code>sigma.sq.mu.ig</code> (inverse-Gamma prior on the abundance random effect variances), <code>sigma.sq.p.ig</code> (inverse-Gamma prior on the detection random effect variances), <code>kappa.unif</code> (uniform prior on the species-specific overdispersion parameters). For all parameters except the species-specific overdispersion parameters, each tag consists of a list with elements corresponding to the mean and variance for normal priors and scale and shape for inverse-Gamma priors. Values can be specified individually for each parameter or as a single value if the same prior is assigned to all parameters of a given type. For the species-specific overdispersion parameters, the prior is specified as a list with two elements representing the lower and upper bound of the uniform distribution, where each of the elements can be a single value if the same prior is used for all species, or a vector of values for each species if specifying a different prior for each species.</p>
<p>By default, we set the prior hyperparameter values for the community-level means to a mean of 0 and a variance of 100 for abundance and 2.72 for detection, which results in a vague prior on the probability scale as we discussed for the single-species N-mixture model. Below we specify these priors explicitly. For the community-level variance parameters, by default we set the scale and shape parameters to 0.1 following the recommendations of <span class="citation">(Lunn et al. 2013)</span>, which results in a weakly informative prior on the community-level variances. This may lead to shrinkage of the community-level variance towards zero under certain circumstances so that all species will have fairly similar values for the species-specific covariate effect <span class="citation">(Gelman 2006)</span>, although we have found multi-species models to be relatively robust to this prior specification. We are in the process of implementing half-Cauchy and half-t priors for the variance parameters in all multi-species models in <code>spAbundance</code> (and <code>spOccupancy</code>), which generally result in less shrinkage toward zero than the inverse-Gamma <span class="citation">(Gelman 2006)</span>. For the negative binomial overdispersion parameters, we by default use a lower bound of 0 and upper bound of 100 for the uniform priors for each species, as we did in the single-species (univariate) models. Below we explicitly set these default prior values for our example.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true"></a>ms.priors &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">beta.comm.normal =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">var =</span> <span class="fl">2.72</span>),</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true"></a>                  <span class="dt">alpha.comm.normal =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">var =</span> <span class="fl">2.72</span>),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true"></a>                  <span class="dt">tau.sq.beta.ig =</span> <span class="kw">list</span>(<span class="dt">a =</span> <span class="fl">0.1</span>, <span class="dt">b =</span> <span class="fl">0.1</span>),</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true"></a>                  <span class="dt">tau.sq.alpha.ig =</span> <span class="kw">list</span>(<span class="dt">a =</span> <span class="fl">0.1</span>, <span class="dt">b =</span> <span class="fl">0.1</span>), </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true"></a>                  <span class="dt">kappa.unif =</span> <span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">100</span>))</span></code></pre></div>
<p>All that’s now left to do is specify the number of threads to use (<code>n.omp.threads</code>), the number of MCMC samples (which we do by specifying the number of batches <code>n.batch</code> and batch length <code>batch.length</code>), the initial tuning variances (<code>tuning</code>), the amount of samples to discard as burn-in (<code>n.burn</code>), the thinning rate (<code>n.thin</code>), and arguments to control the display of sampler progress (<code>verbose</code>, <code>n.report</code>). Note for the tuning variances, we do not need to specify initial tuning values for any of the community-level parameters, as those parameters can be sampled with an efficient Gibbs update. We will also run the model with a Poisson distribution for abundance, which later we will shortly compare to a negative binomial.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a><span class="co"># Specify initial tuning values</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true"></a>ms.tuning &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">beta =</span> <span class="fl">0.3</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">beta.star =</span> <span class="fl">0.5</span>, <span class="dt">kappa =</span> <span class="fl">0.5</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true"></a><span class="co"># Approx. run time:  2.5 min</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true"></a>out.ms &lt;-<span class="st"> </span><span class="kw">msNMix</span>(<span class="dt">abund.formula =</span> abund.ms.formula,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true"></a>                  <span class="dt">det.formula =</span> det.ms.formula,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true"></a>                  <span class="dt">data =</span> dataNMixSim,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true"></a>                  <span class="dt">inits =</span> ms.inits,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true"></a>          <span class="dt">n.batch =</span> <span class="dv">800</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true"></a>          <span class="dt">tuning =</span> ms.tuning,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true"></a>          <span class="dt">batch.length =</span> <span class="dv">25</span>,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true"></a>                  <span class="dt">priors =</span> ms.priors,</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true"></a>                  <span class="dt">n.omp.threads =</span> <span class="dv">1</span>,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true"></a>                  <span class="dt">verbose =</span> <span class="ot">TRUE</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true"></a>                  <span class="dt">n.report =</span> <span class="dv">200</span>,</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true"></a>                  <span class="dt">n.burn =</span> <span class="dv">10000</span>,</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true"></a>                  <span class="dt">n.thin =</span> <span class="dv">10</span>,</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true"></a>                  <span class="dt">n.chains =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>----------------------------------------
    Preparing to run the model
----------------------------------------</code></pre>
<pre><code>No prior specified for sigma.sq.mu.ig.
Setting prior shape to 0.1 and prior scale to 0.1</code></pre>
<pre><code>----------------------------------------
    Model description
----------------------------------------
Multispecies Poisson N-Mixture model fit with 225 sites and 6 species.

Samples per Chain: 20000 
Burn-in: 10000 
Thinning Rate: 10 
Number of Chains: 3 
Total Posterior Samples: 3000 

Source compiled with OpenMP support and model fit using 1 thread(s).

Adaptive Metropolis with target acceptance rate: 43.0
----------------------------------------
    Chain 1
----------------------------------------
Sampling ... 
Batch: 200 of 800, 25.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     24.0        0.23836
    1   alpha[1]    40.0        0.32825
    2   beta[1]     40.0        0.20312
    2   alpha[1]    48.0        0.37010
    3   beta[1]     36.0        0.24318
    3   alpha[1]    56.0        0.36277
    4   beta[1]     24.0        0.16630
    4   alpha[1]    40.0        0.20722
    5   beta[1]     40.0        0.18750
    5   alpha[1]    48.0        0.24318
    6   beta[1]     44.0        0.16630
    6   alpha[1]    52.0        0.24809
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     56.0        0.23836
    1   alpha[1]    40.0        0.34165
    2   beta[1]     32.0        0.22003
    2   alpha[1]    48.0        0.34855
    3   beta[1]     40.0        0.25310
    3   alpha[1]    48.0        0.34855
    4   beta[1]     48.0        0.16966
    4   alpha[1]    40.0        0.19910
    5   beta[1]     28.0        0.18015
    5   alpha[1]    60.0        0.23836
    6   beta[1]     36.0        0.16630
    6   alpha[1]    44.0        0.25310
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     32.0        0.22901
    1   alpha[1]    40.0        0.33488
    2   beta[1]     48.0        0.20312
    2   alpha[1]    36.0        0.36277
    3   beta[1]     40.0        0.24809
    3   alpha[1]    40.0        0.37010
    4   beta[1]     24.0        0.15978
    4   alpha[1]    56.0        0.21568
    5   beta[1]     64.0        0.17658
    5   alpha[1]    72.0        0.23836
    6   beta[1]     32.0        0.14457
    6   alpha[1]    52.0        0.24318
-------------------------------------------------
Batch: 800 of 800, 100.00%
----------------------------------------
    Chain 2
----------------------------------------
Sampling ... 
Batch: 200 of 800, 25.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     44.0        0.23836
    1   alpha[1]    36.0        0.36277
    2   beta[1]     36.0        0.21141
    2   alpha[1]    20.0        0.38521
    3   beta[1]     48.0        0.28537
    3   alpha[1]    28.0        0.37010
    4   beta[1]     40.0        0.18015
    4   alpha[1]    36.0        0.21141
    5   beta[1]     52.0        0.19129
    5   alpha[1]    48.0        0.25821
    6   beta[1]     44.0        0.17308
    6   alpha[1]    36.0        0.25310
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     36.0        0.23364
    1   alpha[1]    28.0        0.33488
    2   beta[1]     40.0        0.22003
    2   alpha[1]    56.0        0.34855
    3   beta[1]     36.0        0.23364
    3   alpha[1]    32.0        0.37758
    4   beta[1]     36.0        0.14749
    4   alpha[1]    48.0        0.20722
    5   beta[1]     56.0        0.20312
    5   alpha[1]    48.0        0.25821
    6   beta[1]     40.0        0.15351
    6   alpha[1]    24.0        0.25310
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     56.0        0.25821
    1   alpha[1]    36.0        0.34165
    2   beta[1]     48.0        0.24809
    2   alpha[1]    16.0        0.36277
    3   beta[1]     28.0        0.26875
    3   alpha[1]    40.0        0.37010
    4   beta[1]     60.0        0.15661
    4   alpha[1]    64.0        0.19515
    5   beta[1]     56.0        0.17658
    5   alpha[1]    44.0        0.25821
    6   beta[1]     44.0        0.15661
    6   alpha[1]    52.0        0.25821
-------------------------------------------------
Batch: 800 of 800, 100.00%
----------------------------------------
    Chain 3
----------------------------------------
Sampling ... 
Batch: 200 of 800, 25.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     60.0        0.25310
    1   alpha[1]    36.0        0.34855
    2   beta[1]     44.0        0.22448
    2   alpha[1]    52.0        0.36277
    3   beta[1]     40.0        0.23836
    3   alpha[1]    56.0        0.37758
    4   beta[1]     16.0        0.16301
    4   alpha[1]    56.0        0.20722
    5   beta[1]     28.0        0.19910
    5   alpha[1]    28.0        0.24809
    6   beta[1]     36.0        0.16966
    6   alpha[1]    56.0        0.25310
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     40.0        0.23836
    1   alpha[1]    44.0        0.36277
    2   beta[1]     52.0        0.22901
    2   alpha[1]    32.0        0.37010
    3   beta[1]     44.0        0.26875
    3   alpha[1]    36.0        0.37010
    4   beta[1]     36.0        0.16301
    4   alpha[1]    40.0        0.19129
    5   beta[1]     52.0        0.19129
    5   alpha[1]    32.0        0.25821
    6   beta[1]     64.0        0.16630
    6   alpha[1]    44.0        0.25821
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     36.0        0.26875
    1   alpha[1]    40.0        0.36277
    2   beta[1]     52.0        0.20722
    2   alpha[1]    44.0        0.35559
    3   beta[1]     28.0        0.27418
    3   alpha[1]    60.0        0.36277
    4   beta[1]     40.0        0.15047
    4   alpha[1]    40.0        0.19910
    5   beta[1]     36.0        0.18750
    5   alpha[1]    60.0        0.27418
    6   beta[1]     48.0        0.15661
    6   alpha[1]    32.0        0.26343
-------------------------------------------------
Batch: 800 of 800, 100.00%</code></pre>
<p>The resulting object <code>out.ms</code> is a list of class <code>msNMix</code> consisting primarily of posterior samples of all community and species-level parameters, as well as some additional objects that are used for summaries, prediction, and model fit evaluation. We can display a nice summary of these results using the <code>summary()</code> function as before. For multi-species objects, when using summary we need to specify the level of parameters we want to summarize. We do this using the argument <code>level</code>, which takes values <code>community</code>, <code>species</code>, or <code>both</code> to print results for community-level parameters, species-level parameters, or all parameters. By default, <code>level</code> is set to <code>both</code> to display both species and community-level parameters.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a><span class="kw">summary</span>(out.ms)</span></code></pre></div>
<pre><code>
Call:
msNMix(abund.formula = abund.ms.formula, det.formula = det.ms.formula, 
    data = dataNMixSim, inits = ms.inits, priors = ms.priors, 
    tuning = ms.tuning, n.batch = 800, batch.length = 25, n.omp.threads = 1, 
    verbose = TRUE, n.report = 200, n.burn = 10000, n.thin = 10, 
    n.chains = 3)

Samples per Chain: 20000
Burn-in: 10000
Thinning Rate: 10
Number of Chains: 3
Total Posterior Samples: 3000
Run Time (min): 2.5065

----------------------------------------
    Community Level
----------------------------------------
Abundance Means (log scale): 
                      Mean     SD    2.5%     50%   97.5%   Rhat  ESS
(Intercept)        -0.7114 0.2156 -1.1273 -0.7114 -0.2924 1.0009 1065
scale(abund.cov.1)  0.0132 0.3183 -0.6200  0.0119  0.6282 1.0034 2632

Abundance Variances (log scale): 
                     Mean     SD   2.5%    50%  97.5%   Rhat  ESS
(Intercept)        0.2236 0.2671 0.0356 0.1476 0.8587 1.0048 1634
scale(abund.cov.1) 0.6684 0.6560 0.1675 0.4819 2.3871 1.0017 3000

Abundance Random Effect Variances (log scale): 
                             Mean     SD   2.5%    50%  97.5%   Rhat  ESS
(Intercept)-abund.factor.1 0.4947 0.1363 0.2892 0.4734 0.8064 1.0054 1404

Detection Means (logit scale): 
                   Mean     SD    2.5%    50%  97.5%   Rhat  ESS
(Intercept)      0.0019 0.3760 -0.7613 0.0023 0.7306 0.9996 3000
scale(det.cov.1) 0.4559 0.4296 -0.3995 0.4619 1.3398 1.0030 2774
scale(det.cov.2) 1.1217 0.4759  0.1317 1.1396 2.0328 1.0025 3000
Detection Variances (logit scale): 
                   Mean     SD   2.5%    50%  97.5%   Rhat  ESS
(Intercept)      0.8901 0.9809 0.1952 0.6068 3.2209 1.0010 2804
scale(det.cov.1) 1.2037 1.3635 0.2705 0.8614 4.3015 1.0221 3000
scale(det.cov.2) 1.5826 4.7719 0.3394 1.0541 5.4607 1.2665 3000

----------------------------------------
    Species Level
----------------------------------------
Abundance (log scale): 
                          Mean     SD    2.5%     50%   97.5%   Rhat  ESS
(Intercept)-sp1        -0.9185 0.2121 -1.3474 -0.9154 -0.4939 1.0030  797
(Intercept)-sp2        -0.7123 0.2140 -1.1354 -0.7115 -0.2941 1.0059  538
(Intercept)-sp3        -1.0665 0.2550 -1.5694 -1.0552 -0.5978 1.0060  622
(Intercept)-sp4        -0.4496 0.2314 -0.8863 -0.4553  0.0164 1.0116  271
(Intercept)-sp5        -0.6344 0.2337 -1.0820 -0.6394 -0.1578 1.0238  337
(Intercept)-sp6        -0.4985 0.2148 -0.9039 -0.5009 -0.0568 1.0329  357
scale(abund.cov.1)-sp1  0.1004 0.1122 -0.1082  0.1002  0.3205 1.0080 2564
scale(abund.cov.1)-sp2  0.4796 0.1081  0.2692  0.4786  0.6955 1.0009 2186
scale(abund.cov.1)-sp3  0.2762 0.1376  0.0107  0.2764  0.5487 0.9998 2010
scale(abund.cov.1)-sp4  0.6943 0.0880  0.5152  0.6959  0.8672 1.0014 1436
scale(abund.cov.1)-sp5 -0.5340 0.1117 -0.7562 -0.5323 -0.3203 1.0023 1172
scale(abund.cov.1)-sp6 -0.9487 0.0664 -1.0785 -0.9492 -0.8156 1.0001 1641

Detection (logit scale): 
                        Mean     SD    2.5%     50%   97.5%   Rhat  ESS
(Intercept)-sp1       0.8618 0.1839  0.5070  0.8629  1.2243 1.0000 1710
(Intercept)-sp2       0.2490 0.1758 -0.0857  0.2504  0.6051 1.0079 1718
(Intercept)-sp3      -0.5470 0.2045 -0.9690 -0.5435 -0.1541 1.0054 1130
(Intercept)-sp4      -0.3431 0.1391 -0.6315 -0.3371 -0.0820 1.0008  699
(Intercept)-sp5      -0.9358 0.1898 -1.3169 -0.9317 -0.5782 1.0118  490
(Intercept)-sp6       0.6813 0.1340  0.4196  0.6781  0.9441 1.0017 1588
scale(det.cov.1)-sp1  1.8874 0.2418  1.4293  1.8780  2.4020 1.0016 2073
scale(det.cov.1)-sp2  0.2920 0.1761 -0.0470  0.2924  0.6316 1.0048 2231
scale(det.cov.1)-sp3  1.1295 0.2059  0.7435  1.1229  1.5524 1.0002 2106
scale(det.cov.1)-sp4 -0.0460 0.0876 -0.2186 -0.0465  0.1255 0.9998 2989
scale(det.cov.1)-sp5  0.1074 0.1191 -0.1253  0.1053  0.3396 1.0003 2417
scale(det.cov.1)-sp6 -0.4363 0.1220 -0.6798 -0.4308 -0.2080 0.9998 2184
scale(det.cov.2)-sp1  0.0209 0.1515 -0.2700  0.0215  0.3225 1.0013 2571
scale(det.cov.2)-sp2  2.5807 0.2937  2.0405  2.5706  3.2026 1.0054 1967
scale(det.cov.2)-sp3  0.6688 0.1809  0.3115  0.6666  1.0318 1.0001 2158
scale(det.cov.2)-sp4  0.9996 0.1080  0.7867  0.9970  1.2176 1.0001 2087
scale(det.cov.2)-sp5  0.8878 0.1319  0.6360  0.8845  1.1467 1.0018 2427
scale(det.cov.2)-sp6  2.1546 0.1795  1.8173  2.1459  2.5084 1.0008 1921</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a><span class="co"># Or more explicitly</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true"></a><span class="co"># summary(out.ms, level = &#39;both&#39;)</span></span></code></pre></div>
<p>We see adequate convergence and mixing of all model parameters, with ESS values fairly large and Rhat values less (or very close to) 1.1. Looking at the community-level variance parameters, we can see there is fairly minimal variation among average abundance of each species (i.e., the intercept), with larger variable in the effect of the covariate on abundance, which is further seen by looking at the species-specific effects of the covariate, which range from highly positive to highly negative.</p>
</div>
<div id="posterior-predictive-checks-2" class="section level2">
<h2>Posterior predictive checks</h2>
<p>As with single-species models, we can use the <code>ppcAbund()</code> function to perform posterior predictive checks, and summarize the check with a Bayesian p-value using the <code>summary()</code> function. The <code>summary()</code> function again requires the <code>level</code> argument to specify if you want an overall Bayesian p-value for the entire community (<code>level = &#39;community&#39;</code>), each individual species (<code>level = &#39;species&#39;</code>), or for both (<code>level = &#39;both&#39;</code>). By default, we set `level = ‘both’. This time, we use a chi-squared test statistic, grouping the data by replicates (again, we just do this to display the different ways of performing posterior predictive checks, and for a full analysis we would explore multiple fit statistics and ways of grouping the data).</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a>ppc.ms.out &lt;-<span class="st"> </span><span class="kw">ppcAbund</span>(out.ms, <span class="dt">fit.stat =</span> <span class="st">&#39;chi-squared&#39;</span>, <span class="dt">group =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>Currently on species 1 out of 6</code></pre>
<pre><code>Currently on species 2 out of 6</code></pre>
<pre><code>Currently on species 3 out of 6</code></pre>
<pre><code>Currently on species 4 out of 6</code></pre>
<pre><code>Currently on species 5 out of 6</code></pre>
<pre><code>Currently on species 6 out of 6</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true"></a><span class="kw">summary</span>(ppc.ms.out)</span></code></pre></div>
<pre><code>
Call:
ppcAbund(object = out.ms, fit.stat = &quot;chi-squared&quot;, group = 2)

Samples per Chain: 20000
Burn-in: 10000
Thinning Rate: 10
Number of Chains: 3
Total Posterior Samples: 3000

----------------------------------------
    Community Level
----------------------------------------
Bayesian p-value:  0.4709 

----------------------------------------
    Species Level
----------------------------------------
sp1 Bayesian p-value: 0.4897
sp2 Bayesian p-value: 0.654
sp3 Bayesian p-value: 0.745
sp4 Bayesian p-value: 0.046
sp5 Bayesian p-value: 0.2637
sp6 Bayesian p-value: 0.627
Fit statistic:  chi-squared </code></pre>
<p>Here we see mixed results of the posterior predictive check, with the fourth species having a fairly small Bayesian p-value, suggesting the model does not fit very well for that species. This is likely a result of overdispersion in the abundance values for that species which the Poisson multi-species N-mixture model is not accounting for. Here we will resist further temptations to identify the source of the inadequate fit for the fourth species.</p>
</div>
<div id="model-selection-using-waic-2" class="section level2">
<h2>Model selection using WAIC</h2>
<p>We can compute the WAIC for comparison with alternative models using the <code>waicAbund()</code> function. For multi-species models, we can calculate the WAIC for the entire data set, or we can calculate it separately for each species. This is done by using the logical <code>by.sp</code> argument. Note that the WAIC for the entire data set is simply the sum of all the WAIC values for the individual responses. Below we calculate the WAIC by species for the multi-species model and compare the WAIC for species 1 to the corresponding WAIC for the non-spatial single-species model we fit for that species.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true"></a><span class="co"># Multi-species Poisson N-mixture model</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true"></a><span class="kw">waicAbund</span>(out.ms, <span class="dt">by.sp =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>Currently on species 1 out of 6</code></pre>
<pre><code>Currently on species 2 out of 6</code></pre>
<pre><code>Currently on species 3 out of 6</code></pre>
<pre><code>Currently on species 4 out of 6</code></pre>
<pre><code>Currently on species 5 out of 6</code></pre>
<pre><code>Currently on species 6 out of 6</code></pre>
<pre><code>       elpd       pD     WAIC
1 -273.7954 16.05740 579.7056
2 -282.9103 20.78161 607.3838
3 -216.5882 13.26221 459.7009
4 -433.5861 10.55211 888.2763
5 -300.8018 11.65785 624.9194
6 -362.0390 10.42128 744.9206</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true"></a><span class="co"># Single-species Poisson N-mixture model for species 1</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true"></a><span class="kw">waicAbund</span>(out)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>      elpd         pD       WAIC 
-273.35113   17.14231  580.98690 </code></pre>
<p>Here we see nearly identical WAIC values for species 1 across a single-species model vs. a multi-species model. Next, we fit a multi-species negative binomial N-mixture model for comparison with the Poisson multi-species model</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true"></a><span class="co"># Approx. run time:  2.7 min</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true"></a>out.ms.nb &lt;-<span class="st"> </span><span class="kw">msNMix</span>(<span class="dt">abund.formula =</span> abund.ms.formula,</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true"></a>                  <span class="dt">det.formula =</span> det.ms.formula,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true"></a>                  <span class="dt">data =</span> dataNMixSim,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true"></a>                  <span class="dt">inits =</span> ms.inits,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true"></a>          <span class="dt">n.batch =</span> <span class="dv">800</span>,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true"></a>          <span class="dt">tuning =</span> ms.tuning,</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true"></a>          <span class="dt">batch.length =</span> <span class="dv">25</span>,</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true"></a>                  <span class="dt">priors =</span> ms.priors,</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true"></a>                  <span class="dt">n.omp.threads =</span> <span class="dv">1</span>,</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true"></a>                  <span class="dt">verbose =</span> <span class="ot">TRUE</span>,</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true"></a>          <span class="dt">family =</span> <span class="st">&#39;NB&#39;</span>,</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true"></a>                  <span class="dt">n.report =</span> <span class="dv">200</span>,</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true"></a>                  <span class="dt">n.burn =</span> <span class="dv">10000</span>,</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true"></a>                  <span class="dt">n.thin =</span> <span class="dv">10</span>,</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true"></a>                  <span class="dt">n.chains =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>----------------------------------------
    Preparing to run the model
----------------------------------------</code></pre>
<pre><code>No prior specified for sigma.sq.mu.ig.
Setting prior shape to 0.1 and prior scale to 0.1</code></pre>
<pre><code>----------------------------------------
    Model description
----------------------------------------
Multispecies Negative Binomial N-Mixture model fit with 225 sites and 6 species.

Samples per Chain: 20000 
Burn-in: 10000 
Thinning Rate: 10 
Number of Chains: 3 
Total Posterior Samples: 3000 

Source compiled with OpenMP support and model fit using 1 thread(s).

Adaptive Metropolis with target acceptance rate: 43.0
----------------------------------------
    Chain 1
----------------------------------------
Sampling ... 
Batch: 200 of 800, 25.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     32.0        0.32825
    1   alpha[1]    32.0        0.33488
    2   beta[1]     44.0        0.24318
    2   alpha[1]    32.0        0.36277
    3   beta[1]     40.0        0.26343
    3   alpha[1]    44.0        0.36277
    4   beta[1]     40.0        0.16301
    4   alpha[1]    44.0        0.20722
    5   beta[1]     20.0        0.19515
    5   alpha[1]    44.0        0.25310
    6   beta[1]     44.0        0.17308
    6   alpha[1]    56.0        0.26343
    1   kappa       56.0        0.84947
    2   kappa       44.0        1.03754
    3   kappa       60.0        2.45187
    4   kappa       48.0        2.87730
    5   kappa       60.0        2.99473
    6   kappa       64.0        2.93543
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     36.0        0.30914
    1   alpha[1]    44.0        0.34165
    2   beta[1]     16.0        0.26343
    2   alpha[1]    32.0        0.36277
    3   beta[1]     48.0        0.25821
    3   alpha[1]    36.0        0.37758
    4   beta[1]     40.0        0.16301
    4   alpha[1]    56.0        0.22003
    5   beta[1]     56.0        0.19129
    5   alpha[1]    36.0        0.25821
    6   beta[1]     44.0        0.15978
    6   alpha[1]    44.0        0.24318
    1   kappa       52.0        0.88413
    2   kappa       44.0        0.97712
    3   kappa       28.0        4.37914
    4   kappa       52.0        3.65777
    5   kappa       48.0        3.96241
    6   kappa       36.0        3.30968
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     52.0        0.34165
    1   alpha[1]    52.0        0.34165
    2   beta[1]     36.0        0.25821
    2   alpha[1]    60.0        0.34855
    3   beta[1]     52.0        0.26343
    3   alpha[1]    44.0        0.34855
    4   beta[1]     60.0        0.16966
    4   alpha[1]    44.0        0.18750
    5   beta[1]     24.0        0.17658
    5   alpha[1]    40.0        0.25310
    6   beta[1]     32.0        0.16301
    6   alpha[1]    48.0        0.25310
    1   kappa       40.0        0.86663
    2   kappa       32.0        1.03754
    3   kappa       12.0        4.12412
    4   kappa       44.0        3.51434
    5   kappa       52.0        3.88395
    6   kappa       48.0        3.24415
-------------------------------------------------
Batch: 800 of 800, 100.00%
----------------------------------------
    Chain 2
----------------------------------------
Sampling ... 
Batch: 200 of 800, 25.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     28.0        0.32175
    1   alpha[1]    36.0        0.34855
    2   beta[1]     44.0        0.28537
    2   alpha[1]    40.0        0.35559
    3   beta[1]     52.0        0.28537
    3   alpha[1]    36.0        0.35559
    4   beta[1]     60.0        0.16301
    4   alpha[1]    48.0        0.23364
    5   beta[1]     48.0        0.19129
    5   alpha[1]    44.0        0.26343
    6   beta[1]     32.0        0.16630
    6   alpha[1]    44.0        0.25821
    1   kappa       44.0        0.88413
    2   kappa       52.0        1.01700
    3   kappa       44.0        4.37914
    4   kappa       40.0        3.37654
    5   kappa       64.0        3.73166
    6   kappa       68.0        3.73166
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     56.0        0.30914
    1   alpha[1]    48.0        0.34165
    2   beta[1]     40.0        0.26343
    2   alpha[1]    48.0        0.34855
    3   beta[1]     48.0        0.26343
    3   alpha[1]    40.0        0.36277
    4   beta[1]     48.0        0.16966
    4   alpha[1]    32.0        0.21141
    5   beta[1]     32.0        0.18015
    5   alpha[1]    40.0        0.24318
    6   beta[1]     36.0        0.16630
    6   alpha[1]    52.0        0.25821
    1   kappa       40.0        0.88413
    2   kappa       44.0        1.14666
    3   kappa       52.0        3.80704
    4   kappa       48.0        3.65777
    5   kappa       48.0        4.04246
    6   kappa       48.0        3.17991
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     32.0        0.32175
    1   alpha[1]    40.0        0.33488
    2   beta[1]     28.0        0.28537
    2   alpha[1]    44.0        0.37758
    3   beta[1]     76.0        0.26875
    3   alpha[1]    68.0        0.34855
    4   beta[1]     44.0        0.15047
    4   alpha[1]    32.0        0.19515
    5   beta[1]     52.0        0.19129
    5   alpha[1]    40.0        0.25821
    6   beta[1]     8.0     0.18015
    6   alpha[1]    36.0        0.22448
    1   kappa       56.0        0.83265
    2   kappa       32.0        0.93881
    3   kappa       8.0     4.37914
    4   kappa       32.0        3.58534
    5   kappa       48.0        3.80704
    6   kappa       60.0        2.99473
-------------------------------------------------
Batch: 800 of 800, 100.00%
----------------------------------------
    Chain 3
----------------------------------------
Sampling ... 
Batch: 200 of 800, 25.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     36.0        0.32825
    1   alpha[1]    44.0        0.33488
    2   beta[1]     48.0        0.26875
    2   alpha[1]    36.0        0.35559
    3   beta[1]     52.0        0.26875
    3   alpha[1]    44.0        0.34855
    4   beta[1]     32.0        0.14749
    4   alpha[1]    32.0        0.20312
    5   beta[1]     52.0        0.19129
    5   alpha[1]    20.0        0.25821
    6   beta[1]     40.0        0.16630
    6   alpha[1]    24.0        0.25310
    1   kappa       44.0        0.90199
    2   kappa       32.0        1.07988
    3   kappa       48.0        4.29243
    4   kappa       56.0        3.37654
    5   kappa       40.0        3.88395
    6   kappa       52.0        3.58534
-------------------------------------------------
Batch: 400 of 800, 50.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     40.0        0.32175
    1   alpha[1]    36.0        0.32825
    2   beta[1]     60.0        0.26343
    2   alpha[1]    48.0        0.39299
    3   beta[1]     56.0        0.27972
    3   alpha[1]    52.0        0.36277
    4   beta[1]     32.0        0.15978
    4   alpha[1]    36.0        0.19910
    5   beta[1]     36.0        0.19910
    5   alpha[1]    44.0        0.24809
    6   beta[1]     36.0        0.16301
    6   alpha[1]    28.0        0.24809
    1   kappa       56.0        0.86663
    2   kappa       36.0        1.14666
    3   kappa       60.0        4.12412
    4   kappa       48.0        3.30968
    5   kappa       56.0        3.88395
    6   kappa       32.0        3.17991
-------------------------------------------------
Batch: 600 of 800, 75.00%
    Species Parameter   Acceptance  Tuning
    1   beta[1]     28.0        0.30914
    1   alpha[1]    36.0        0.37010
    2   beta[1]     40.0        0.26875
    2   alpha[1]    40.0        0.35559
    3   beta[1]     36.0        0.27418
    3   alpha[1]    28.0        0.36277
    4   beta[1]     48.0        0.16966
    4   alpha[1]    40.0        0.21568
    5   beta[1]     32.0        0.17658
    5   alpha[1]    48.0        0.24809
    6   beta[1]     68.0        0.15978
    6   alpha[1]    64.0        0.26343
    1   kappa       32.0        0.84947
    2   kappa       52.0        1.12395
    3   kappa       56.0        4.04246
    4   kappa       52.0        3.65777
    5   kappa       40.0        3.65777
    6   kappa       48.0        3.73166
-------------------------------------------------
Batch: 800 of 800, 100.00%</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true"></a><span class="co"># Negative binomial</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true"></a><span class="kw">waicAbund</span>(out.ms.nb, <span class="dt">by.sp =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>Currently on species 1 out of 6</code></pre>
<pre><code>Currently on species 2 out of 6</code></pre>
<pre><code>Currently on species 3 out of 6</code></pre>
<pre><code>Currently on species 4 out of 6</code></pre>
<pre><code>Currently on species 5 out of 6</code></pre>
<pre><code>Currently on species 6 out of 6</code></pre>
<pre><code>       elpd       pD     WAIC
1 -266.3479 11.19079 555.0773
2 -279.0550 16.93178 591.9736
3 -215.4592 13.75449 458.4274
4 -434.1502 10.36076 889.0219
5 -300.9640 11.21852 624.3651
6 -362.9142 10.36994 746.5684</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true"></a><span class="co"># Poisson</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true"></a><span class="kw">waicAbund</span>(out.ms, <span class="dt">by.sp =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>N.max not specified. Setting upper index of integration of N to 10 plus
the largest estimated abundance value at each site in object$N.samples</code></pre>
<pre><code>Currently on species 1 out of 6</code></pre>
<pre><code>Currently on species 2 out of 6</code></pre>
<pre><code>Currently on species 3 out of 6</code></pre>
<pre><code>Currently on species 4 out of 6</code></pre>
<pre><code>Currently on species 5 out of 6</code></pre>
<pre><code>Currently on species 6 out of 6</code></pre>
<pre><code>       elpd       pD     WAIC
1 -273.7954 16.05740 579.7056
2 -282.9103 20.78161 607.3838
3 -216.5882 13.26221 459.7009
4 -433.5861 10.55211 888.2763
5 -300.8018 11.65785 624.9194
6 -362.0390 10.42128 744.9206</code></pre>
<p>Here we see the negative binomial model provides pretty substantial improvements for the first two species in the data set, while the last four species all have WAIC values that are very similar across the two models.</p>
</div>
<div id="prediction-2" class="section level2">
<h2>Prediction</h2>
<p>Prediction proceeds exactly as we have seen previously with the single-species non-spatial N-mixture model. Below we generate a marginal effects plot for the effect of the covariate on each of the six species in the data set. Because we saw substantial improvements in WAIC for the first two species in the data set, we will use the negative binomial model</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true"></a>out.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(out.ms.nb, X<span class="fl">.0</span>, <span class="dt">ignore.RE =</span> <span class="ot">TRUE</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true"></a><span class="co"># Look at the resulting object</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true"></a><span class="kw">str</span>(out.pred)</span></code></pre></div>
<pre><code>List of 3
 $ mu.0.samples: num [1:3000, 1:6, 1:100] 0.416 0.524 0.51 0.243 0.687 ...
 $ N.0.samples : num [1:3000, 1:6, 1:100] 0 0 0 0 3 0 1 1 0 0 ...
 $ call        : language predict.msNMix(object = out.ms.nb, X.0 = X.0, ignore.RE = TRUE)
 - attr(*, &quot;class&quot;)= chr &quot;predict.msNMix&quot;</code></pre>
<p>Notice that <code>mu.0.samples</code> (expected abundances) and <code>N.0.samples</code> (mean abundances) are now three-dimensional arrays, with dimensions corresponding to posterior sample, species, and site. Now, we make a marginal effect plot for each species.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true"></a>mu.<span class="fl">0.</span>quants &lt;-<span class="st"> </span><span class="kw">apply</span>(out.pred<span class="op">$</span>mu.<span class="fl">0.</span>samples, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), quantile,</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true"></a>                          <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true"></a><span class="co"># Put stuff together for plotting with ggplot2</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true"></a>mu.<span class="fl">0.</span>plot.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">mu.med =</span> <span class="kw">c</span>(mu.<span class="fl">0.</span>quants[<span class="dv">2</span>, , ]), </span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true"></a>               <span class="dt">mu.low =</span> <span class="kw">c</span>(mu.<span class="fl">0.</span>quants[<span class="dv">1</span>, , ]),</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true"></a>               <span class="dt">mu.high =</span> <span class="kw">c</span>(mu.<span class="fl">0.</span>quants[<span class="dv">3</span>, , ]),</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true"></a>                           <span class="dt">sp =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.sp, <span class="kw">nrow</span>(X<span class="fl">.0</span>)),</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true"></a>                           <span class="dt">abund.cov.1 =</span> <span class="kw">rep</span>(cov.pred.vals, <span class="dt">each =</span> n.sp))</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true"></a><span class="kw">ggplot</span>(mu.<span class="fl">0.</span>plot.df, <span class="kw">aes</span>(<span class="dt">x =</span> abund.cov<span class="fl">.1</span>, <span class="dt">y =</span> mu.med)) <span class="op">+</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mu.low, <span class="dt">ymax =</span> mu.high), <span class="dt">fill =</span> <span class="st">&#39;grey70&#39;</span>) <span class="op">+</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(sp)) <span class="op">+</span></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Covariate&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Expected abundance&#39;</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="latent-factor-multi-species-n-mixture-models" class="section level1">
<h1>Latent factor multi-species N-mixture models</h1>
<div id="basic-model-description-3" class="section level2">
<h2>Basic model description</h2>
</div>
<div id="fitting-latent-factor-multi-species-n-mixture-models-with-lfmsnmix" class="section level2">
<h2>Fitting latent factor multi-species N-mixture models with <code>lfMsNMix()</code></h2>
</div>
<div id="posterior-predictive-checks-3" class="section level2">
<h2>Posterior predictive checks</h2>
</div>
<div id="model-selection-using-waic-3" class="section level2">
<h2>Model selection using WAIC</h2>
</div>
<div id="prediction-3" class="section level2">
<h2>Prediction</h2>
</div>
</div>
<div id="spatial-factor-multi-species-n-mixture-models" class="section level1">
<h1>Spatial factor multi-species N-mixture models</h1>
<div id="basic-model-description-4" class="section level2">
<h2>Basic model description</h2>
</div>
<div id="fitting-spatial-factor-multi-species-n-mixture-models-with-sfmsnmix" class="section level2">
<h2>Fitting spatial factor multi-species N-mixture models with <code>sfMsNMix()</code></h2>
</div>
<div id="posterior-predictive-checks-4" class="section level2">
<h2>Posterior predictive checks</h2>
</div>
<div id="model-selection-using-waic-4" class="section level2">
<h2>Model selection using WAIC</h2>
</div>
<div id="prediction-4" class="section level2">
<h2>Prediction</h2>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references hanging-indent">
<div id="ref-banerjee2003">
<p>Banerjee, Sudipto, Bradley P Carlin, and Alan E Gelfand. 2003. <em>Hierarchical Modeling and Analysis for Spatial Data</em>. Chapman; Hall/CRC.</p>
</div>
<div id="ref-bates2015">
<p>Bates, Douglas, Martin Mächler, Ben Bolker, and Steve Walker. 2015. “Fitting Linear Mixed-Effects Models Using lme4.” <em>Journal of Statistical Software</em> 67 (1): 1–48. <a href="https://doi.org/10.18637/jss.v067.i01">https://doi.org/10.18637/jss.v067.i01</a>.</p>
</div>
<div id="ref-broms2016model">
<p>Broms, Kristin M, Mevin B Hooten, and Ryan M Fitzpatrick. 2016. “Model Selection and Assessment for Multi-Species Occupancy Models.” <em>Ecology</em> 97 (7): 1759–70.</p>
</div>
<div id="ref-brooks1998">
<p>Brooks, Stephen P., and Andrew Gelman. 1998. “General Methods for Monitoring Convergence of Iterative Simulations.” <em>Journal of Computational and Graphical Statistics</em> 7 (4): 434–55.</p>
</div>
<div id="ref-datta2016hierarchical">
<p>Datta, Abhirup, Sudipto Banerjee, Andrew O Finley, and Alan E Gelfand. 2016. “Hierarchical Nearest-Neighbor Gaussian Process Models for Large Geostatistical Datasets.” <em>Journal of the American Statistical Association</em> 111 (514): 800–812.</p>
</div>
<div id="ref-doser2022spoccupancy">
<p>Doser, Jeffrey W, Andrew O Finley, Marc Kéry, and Elise F Zipkin. 2022. “spOccupancy: An R package for single-species, multi-species, and integrated spatial occupancy models.” <em>Methods in Ecology and Evolution</em> 13 (8): 1670–8.</p>
</div>
<div id="ref-finley2020spnngp">
<p>Finley, Andrew O, Abhirup Datta, and Sudipto Banerjee. 2020. “SpNNGP R Package for Nearest Neighbor Gaussian Process Models.” <em>arXiv Preprint arXiv:2001.09111</em>.</p>
</div>
<div id="ref-finley2019efficient">
<p>Finley, Andrew O, Abhirup Datta, Bruce D Cook, Douglas C Morton, Hans E Andersen, and Sudipto Banerjee. 2019. “Efficient Algorithms for Bayesian Nearest Neighbor Gaussian Processes.” <em>Journal of Computational and Graphical Statistics</em> 28 (2): 401–14.</p>
</div>
<div id="ref-gelman2006prior">
<p>Gelman, Andrew. 2006. “Prior Distributions for Variance Parameters in Hierarchical Models (Comment on Article by Browne and Draper).” <em>Bayesian Analysis</em> 1 (3): 515–34.</p>
</div>
<div id="ref-guelat2018">
<p>Guélat, Jérôme, and Marc Kéry. 2018. “Effects of Spatial Autocorrelation and Imperfect Detection on Species Distribution Models.” <em>Methods in Ecology and Evolution</em> 9 (6): 1614–25.</p>
</div>
<div id="ref-hobbs2015">
<p>Hobbs, N Thompson, and Mevin B Hooten. 2015. <em>Bayesian Models</em>. Princeton University Press.</p>
</div>
<div id="ref-hooten2015guide">
<p>Hooten, Mevin B, and N Thompson Hobbs. 2015. “A Guide to Bayesian Model Selection for Ecologists.” <em>Ecological Monographs</em> 85 (1): 3–28.</p>
</div>
<div id="ref-kery2015applied">
<p>Kéry, Marc, and J Andrew Royle. 2016. <em>Applied Hierarchical Modeling in Ecology: Volume 1: Prelude and Static Models</em>. Elsevier Science.</p>
</div>
<div id="ref-lunn2013bugs">
<p>Lunn, David, Christopher Jackson, Nicky Best, Andrew Thomas, and David Spiegelhalter. 2013. “The Bugs Book: A Practical Introduction to Bayesian Analysis.”</p>
</div>
<div id="ref-roberts2009examples">
<p>Roberts, Gareth O, and Jeffrey S Rosenthal. 2009. “Examples of Adaptive Mcmc.” <em>Journal of Computational and Graphical Statistics</em> 18 (2): 349–67.</p>
</div>
<div id="ref-royle2004n">
<p>Royle, J Andrew. 2004. “N-mixture models for estimating population size from spatially replicated counts.” <em>Biometrics</em> 60 (1): 108–15.</p>
</div>
<div id="ref-watanabe2010">
<p>Watanabe, Sumio. 2010. “Asymptotic Equivalence of Bayes Cross Validation and Widely Applicable Information Criterion in Singular Learning Theory.” <em>Journal of Machine Learning Research</em> 11 (12).</p>
</div>
<div id="ref-yamaura2012biodiversity">
<p>Yamaura, Yuichi, J Andrew Royle, Naoaki Shimada, Seigo Asanuma, Tamotsu Sato, Hisatomo Taki, and Shun’ichi Makino. 2012. “Biodiversity of Man-Made Open Habitats in an Underused Country: A Class of Multispecies Abundance Models for Count Data.” <em>Biodiversity and Conservation</em> 21: 1365–80.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
